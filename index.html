<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AISH Health Monitoring System - MongoDB Edition</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Poppins:wght@400;500;600;700&display=swap');
    
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: 'Inter', sans-serif;
      background: #f8f9fa;
      color: #2c3e50;
      min-height: 100vh;
      overflow-x: hidden;
    }
    
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
    @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes slideInRight { from { opacity: 0; transform: translateX(50px); } to { opacity: 1; transform: translateX(0); } }
    @keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-10px); } }
    @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    @keyframes sparkle { 0%, 100% { opacity: 1; transform: scale(1); } 50% { opacity: 0.5; transform: scale(1.2); } }
    @keyframes bounce { 0%, 80%, 100% { transform: translateY(0); } 40% { transform: translateY(-10px); } }
    
    header {
      background: #ffffff;
      border-bottom: 1px solid #e9ecef;
      padding: 20px 0;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }
    
    .header-content {
      max-width: 1600px;
      margin: 0 auto;
      padding: 0 24px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 16px;
    }
    
    .logo {
      display: flex;
      align-items: center;
      gap: 16px;
    }
    
    .logo-icon {
      width: 48px;
      height: 48px;
      border: 2px solid #3498db;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      animation: pulse 3s ease-in-out infinite;
      background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
      color: white;
    }
    
    .logo-text h1 {
      font-family: 'Poppins', sans-serif;
      font-size: 28px;
      font-weight: 700;
      color: #2c3e50;
      letter-spacing: 1px;
    }
    
    .logo-text p {
      color: #7f8c8d;
      font-size: 12px;
      margin-top: 4px;
      text-transform: uppercase;
      letter-spacing: 1px;
      font-weight: 500;
    }
    
    .status {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 20px;
      background: #e8f5e9;
      border-radius: 8px;
      border: 1px solid #81c784;
    }
    
    .status.offline {
      background: #ffebee;
      border-color: #e57373;
    }
    
    .status-dot {
      width: 8px;
      height: 8px;
      background: #4caf50;
      border-radius: 50%;
      animation: pulse 1s infinite;
    }
    
    .status-dot.offline {
      background: #e74c3c;
    }
    
    .status-text {
      font-family: 'Poppins', sans-serif;
      font-size: 11px;
      font-weight: 600;
      color: #2e7d32;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .status-text.offline {
      color: #c62828;
    }
    
    .download-btn {
      padding: 10px 20px;
      background: #27ae60;
      color: white;
      border: none;
      border-radius: 8px;
      font-family: 'Poppins', sans-serif;
      font-size: 11px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 1px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .download-btn:hover {
      background: #229954;
      box-shadow: 0 4px 12px rgba(39, 174, 96, 0.3);
      transform: translateY(-2px);
    }
    
    .user-badge {
      padding: 10px 20px;
      background: #e3f2fd;
      border: 1px solid #90caf9;
      border-radius: 8px;
      font-family: 'Poppins', sans-serif;
      font-size: 11px;
      font-weight: 600;
      color: #1976d2;
      display: none;
      align-items: center;
      gap: 12px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    nav {
      max-width: 1600px;
      margin: 24px auto 0;
      padding: 0 24px;
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }
    
    .nav-btn {
      font-family: 'Poppins', sans-serif;
      padding: 12px 24px;
      background: #ffffff;
      color: #546e7a;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      font-weight: 600;
      font-size: 11px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .nav-btn.active {
      background: #3498db;
      border-color: #3498db;
      color: white;
      box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
    }
    
    .nav-btn:hover:not(.active) {
      background: #f5f5f5;
      border-color: #3498db;
      color: #3498db;
    }
    
    main {
      max-width: 1600px;
      margin: 24px auto 0;
      padding: 0 24px 40px;
    }
    
    .jarvis-panel {
      background: #ffffff;
      border: 1px solid #e9ecef;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
      border-radius: 12px;
      padding: 28px;
      animation: slideIn 0.6s ease-out;
      position: relative;
      margin-bottom: 20px;
    }
    
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 20px;
      margin-bottom: 24px;
    }
    
    .stat-card {
      border-left: 3px solid #3498db;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      transition: all 0.4s ease;
      position: relative;
      padding-left: 20px;
    }
    
    .stat-card:hover {
      transform: translateY(-5px);
      border-left-color: #27ae60;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    
    .stat-label {
      font-family: 'Poppins', sans-serif;
      color: #7f8c8d;
      font-size: 10px;
      font-weight: 600;
      text-transform: uppercase;
      margin-bottom: 10px;
      letter-spacing: 2px;
    }
    
    .stat-value {
      font-family: 'Poppins', sans-serif;
      font-size: 42px;
      font-weight: 700;
      color: #2c3e50;
      line-height: 1;
    }
    
    .stat-icon {
      font-size: 40px;
      opacity: 0.3;
      color: #3498db;
    }
    
    .stat-subtext {
      color: #95a5a6;
      font-size: 12px;
      margin-top: 8px;
      font-weight: 500;
    }
    
    h2 {
      font-family: 'Poppins', sans-serif;
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 20px;
      color: #2c3e50;
      text-transform: uppercase;
      letter-spacing: 2px;
    }
    
    .section-hidden { display: none; }
    .section-visible { display: block; }
    
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(10px);
      z-index: 2000;
      align-items: center;
      justify-content: center;
    }
    
    .modal.active { display: flex; }
    
    .modal-content {
      max-width: 600px;
      width: 90%;
      animation: slideIn 0.6s ease-out;
    }
    
    .character-select {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 16px;
      margin-top: 20px;
    }
    
    .character-card {
      background: #ffffff;
      border: 2px solid #e9ecef;
      border-radius: 12px;
      padding: 24px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .character-card:hover {
      border-color: #3498db;
      box-shadow: 0 4px 16px rgba(52, 152, 219, 0.2);
      transform: translateY(-4px);
    }
    
    .character-icon {
      font-size: 48px;
      margin-bottom: 12px;
    }
    
    .character-name {
      font-family: 'Poppins', sans-serif;
      font-size: 16px;
      color: #2c3e50;
      margin-bottom: 8px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .character-desc {
      font-size: 12px;
      color: #7f8c8d;
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    label {
      display: block;
      color: #546e7a;
      margin-bottom: 8px;
      font-family: 'Poppins', sans-serif;
      font-weight: 600;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    input, select {
      width: 100%;
      padding: 12px 16px;
      background: #f8f9fa;
      color: #2c3e50;
      border: 1px solid #dee2e6;
      border-radius: 8px;
      font-size: 14px;
      font-family: 'Inter', sans-serif;
      font-weight: 500;
      transition: all 0.3s ease;
    }
    
    input::placeholder {
      color: #adb5bd;
    }
    
    input:focus, select:focus {
      background: #ffffff;
      border-color: #3498db;
      outline: none;
      box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
    }
    
    .jarvis-btn {
      font-family: 'Poppins', sans-serif;
      padding: 14px 28px;
      background: #3498db;
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 700;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 2px;
    }
    
    .jarvis-btn:hover:not(:disabled) {
      background: #2980b9;
      box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
      transform: translateY(-2px);
    }
    
    .jarvis-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .jarvis-btn-secondary {
      background: #27ae60;
      color: white;
    }
    
    .jarvis-btn-secondary:hover:not(:disabled) {
      background: #229954;
      box-shadow: 0 4px 12px rgba(39, 174, 96, 0.3);
    }

    .jarvis-btn-danger {
      background: #e74c3c;
      color: white;
      padding: 8px 16px;
      font-size: 10px;
    }

    .jarvis-btn-danger:hover:not(:disabled) {
      background: #c0392b;
      box-shadow: 0 4px 12px rgba(231, 76, 60, 0.3);
    }
    
    .symptom-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 12px;
      margin-bottom: 20px;
    }
    
    .symptom-btn {
      font-family: 'Inter', sans-serif;
      padding: 12px 16px;
      border-radius: 8px;
      border: 2px solid #e9ecef;
      background: #ffffff;
      color: #546e7a;
      cursor: pointer;
      font-weight: 600;
      font-size: 13px;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .symptom-btn.selected {
      border-color: #27ae60;
      background: #e8f5e9;
      color: #27ae60;
    }
    
    .symptom-btn:hover:not(.selected) {
      background: #f8f9fa;
      border-color: #3498db;
      color: #3498db;
    }
    
    .notification {
      position: fixed;
      top: 100px;
      right: 24px;
      background: #ffffff;
      padding: 16px 24px;
      border-radius: 8px;
      border: 1px solid #e9ecef;
      color: #2c3e50;
      font-family: 'Poppins', sans-serif;
      font-weight: 600;
      font-size: 12px;
      animation: slideInRight 0.4s ease;
      z-index: 1000;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
      max-width: 400px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .notification.success {
      background: #e8f5e9;
      border-color: #81c784;
      color: #2e7d32;
    }
    
    .notification.error {
      background: #ffebee;
      border-color: #e57373;
      color: #c62828;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    
    th {
      font-family: 'Poppins', sans-serif;
      padding: 14px;
      text-align: left;
      font-size: 11px;
      font-weight: 700;
      color: #546e7a;
      text-transform: uppercase;
      letter-spacing: 1px;
      border-bottom: 2px solid #e9ecef;
      background: #f8f9fa;
    }
    
    td {
      padding: 14px;
      border-bottom: 1px solid #f1f3f5;
      color: #2c3e50;
      font-size: 13px;
    }
    
    tr:hover {
      background: #f8f9fa;
    }
    
    .symptom-badge {
      display: inline-block;
      padding: 4px 10px;
      background: #e3f2fd;
      color: #1976d2;
      border-radius: 6px;
      margin-right: 6px;
      font-size: 10px;
      font-weight: 600;
      border: 1px solid #90caf9;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .severity-badge {
      font-family: 'Poppins', sans-serif;
      display: inline-block;
      padding: 6px 12px;
      border-radius: 6px;
      font-weight: 700;
      font-size: 10px;
      border: 2px solid;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .severity-high {
      background: #ffebee;
      color: #c62828;
      border-color: #e57373;
    }
    
    .severity-medium {
      background: #fff3e0;
      color: #e65100;
      border-color: #ffb74d;
    }
    
    .severity-low {
      background: #e8f5e9;
      color: #2e7d32;
      border-color: #81c784;
    }
    
    #map {
      height: 400px;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      border: 1px solid #e9ecef;
    }
    
    .location-detect-btn {
      background: #3498db;
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-family: 'Poppins', sans-serif;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-top: 10px;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s ease;
    }
    
    .location-detect-btn:hover {
      background: #2980b9;
      box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
    }
    
    .location-detect-btn:disabled {
      background: #95a5a6;
      cursor: not-allowed;
    }
    
    .location-info {
      background: #e3f2fd;
      padding: 12px;
      border-radius: 8px;
      margin-top: 10px;
      font-size: 12px;
      border: 1px solid #90caf9;
      display: none;
    }
    
    .location-info.show {
      display: block;
    }
    
    .chart-container {
      position: relative;
      height: 300px;
      margin-top: 20px;
    }

    .error-msg {
      color: #e74c3c;
      background: #ffebee;
      padding: 12px;
      border-radius: 8px;
      font-size: 12px;
      margin-top: 12px;
      text-align: center;
      display: none;
      border: 1px solid #e57373;
    }

    .security-note {
      margin-top: 20px;
      padding: 20px;
      background: #fff3e0;
      border-left: 4px solid #f57c00;
      border-radius: 8px;
    }

    .security-note strong {
      color: #e65100;
      font-family: 'Poppins', sans-serif;
      font-size: 14px;
    }

    .security-note p {
      color: #7f8c8d;
      margin-top: 8px;
      font-size: 13px;
    }

    .ai-doctor-avatar {
      width: 120px;
      height: 120px;
      background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 64px;
      position: relative;
      animation: float 3s ease-in-out infinite;
      box-shadow: 0 8px 24px rgba(52, 152, 219, 0.3);
      border: 4px solid #ffffff;
    }
    
    .ai-doctor-avatar::before {
      content: '';
      position: absolute;
      width: 140px;
      height: 140px;
      border: 2px solid #e3f2fd;
      border-radius: 50%;
      animation: rotate 10s linear infinite;
      border-top-color: #3498db;
      border-right-color: transparent;
    }
    
    .ai-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 16px;
      background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
      border-radius: 20px;
      font-family: 'Poppins', sans-serif;
      font-size: 11px;
      font-weight: 700;
      color: white;
      text-transform: uppercase;
      letter-spacing: 1px;
      box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
    }
    
    .ai-badge::before {
      content: '‚ö°';
      animation: sparkle 2s ease-in-out infinite;
    }
    
    .protocol-card {
      background: #ffffff;
      border: 1px solid #e9ecef;
      border-radius: 12px;
      padding: 24px;
      transition: all 0.4s ease;
      position: relative;
    }
    
    .protocol-card:hover {
      transform: translateY(-5px);
      border-color: #3498db;
      box-shadow: 0 8px 24px rgba(52, 152, 219, 0.15);
    }
    
    .protocol-card.do-card {
      border-left: 4px solid #27ae60;
    }
    
    .protocol-card.dont-card {
      border-left: 4px solid #e74c3c;
    }

    .language-selector {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    
    .language-btn {
      font-family: 'Poppins', sans-serif;
      padding: 10px 20px;
      background: #ffffff;
      color: #546e7a;
      border: 2px solid #e9ecef;
      border-radius: 20px;
      font-weight: 600;
      font-size: 11px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .language-btn:hover {
      border-color: #3498db;
      color: #3498db;
      transform: translateY(-2px);
    }
    
    .language-btn.active {
      background: #3498db;
      border-color: #3498db;
      color: white;
      box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
    }

    .ai-thinking {
      display: inline-flex;
      gap: 4px;
      margin-left: 8px;
    }
    
    .ai-thinking span {
      width: 6px;
      height: 6px;
      background: #3498db;
      border-radius: 50%;
      animation: bounce 1.4s ease-in-out infinite;
    }
    
    .ai-thinking span:nth-child(2) {
      animation-delay: 0.2s;
    }
    
    .ai-thinking span:nth-child(3) {
      animation-delay: 0.4s;
    }
    
    /* Chatbot Styles */
    .chat-message {
      animation: slideIn 0.3s ease-out;
    }
    
    .bot-message {
      margin-bottom: 16px;
      padding: 16px;
      background: white;
      border-radius: 12px;
      border-left: 4px solid #3498db;
    }
    
    .user-message {
      margin-bottom: 16px;
      padding: 16px;
      background: #e3f2fd;
      border-radius: 12px;
      border-left: 4px solid #2196f3;
      text-align: right;
    }
    
    .quick-topic-btn {
      padding: 8px 16px;
      background: white;
      color: #856404;
      border: 2px solid #ffc107;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Poppins', sans-serif;
    }
    
    .quick-topic-btn:hover {
      background: #ffc107;
      color: white;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(255, 193, 7, 0.3);
    }
    
    #chatMessages::-webkit-scrollbar {
      width: 8px;
    }
    
    #chatMessages::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 4px;
    }
    
    #chatMessages::-webkit-scrollbar-thumb {
      background: #3498db;
      border-radius: 4px;
    }
    
    #chatMessages::-webkit-scrollbar-thumb:hover {
      background: #2980b9;
    }
    
    /* Floating Chatbot Styles */
    .chatbot-toggle {
      position: fixed;
      bottom: 30px;
      right: 30px;
      width: 70px;
      height: 70px;
      background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
      border-radius: 50%;
      border: none;
      cursor: pointer;
      box-shadow: 0 8px 24px rgba(52, 152, 219, 0.4);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 36px;
      transition: all 0.3s ease;
      z-index: 999;
      animation: float 3s ease-in-out infinite;
    }
    
    .chatbot-toggle:hover {
      transform: scale(1.1) translateY(-5px);
      box-shadow: 0 12px 32px rgba(52, 152, 219, 0.6);
    }
    
    .chatbot-toggle.active {
      background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
    }
    
    .chatbot-popup {
      position: fixed;
      bottom: 120px;
      right: 30px;
      width: 420px;
      max-height: 650px;
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      display: none;
      flex-direction: column;
      z-index: 998;
      animation: slideInRight 0.4s ease-out;
      overflow: hidden;
    }
    
    .chatbot-popup.active {
      display: flex;
    }
    
    .chatbot-header {
      background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
      color: white;
      padding: 20px 24px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-radius: 20px 20px 0 0;
    }
    
    .chatbot-header h3 {
      font-family: 'Poppins', sans-serif;
      font-size: 18px;
      font-weight: 700;
      margin: 0;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .chatbot-close {
      background: rgba(255, 255, 255, 0.2);
      border: none;
      color: white;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }
    
    .chatbot-close:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: rotate(90deg);
    }
    
    .chatbot-body {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
      background: #f8f9fa;
    }
    
    .chatbot-footer {
      padding: 16px 20px;
      background: white;
      border-top: 1px solid #e9ecef;
    }
    
    @media (max-width: 768px) {
      .stats-grid, .character-select { grid-template-columns: 1fr; }
      .symptom-grid { grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); }
      .header-content { flex-direction: column; text-align: center; }
      nav { overflow-x: auto; flex-wrap: nowrap; }
      #map { height: 300px; }
      .logo-text h1 { font-size: 24px; }
      .ai-doctor-avatar { width: 80px; height: 80px; font-size: 48px; }
      .ai-doctor-avatar::before { width: 100px; height: 100px; }
      #chatMessages { height: 300px; }
      
      .chatbot-popup {
        width: calc(100vw - 40px);
        right: 20px;
        bottom: 100px;
        max-height: 500px;
      }
      
      .chatbot-toggle {
        width: 60px;
        height: 60px;
        font-size: 30px;
        bottom: 20px;
        right: 20px;
      }
    }
  </style>
</head>
<body>
  <!-- Login Modal -->
  <div id="loginModal" class="modal active">
    <div class="modal-content">
      <div class="jarvis-panel">
        <h2 style="font-size: 24px; margin-bottom: 10px; text-align: center;">üîí SYSTEM ACCESS REQUIRED</h2>
        <p style="color: #7f8c8d; font-size: 14px; margin-bottom: 32px; text-align: center;">Select your access level to continue</p>
        
        <div class="character-select" id="characterSelect">
          <div class="character-card" data-role="doctor">
            <div class="character-icon">‚öïÔ∏è</div>
            <div class="character-name">Medical Officer</div>
            <div class="character-desc">Healthcare provider access</div>
          </div>
          
          <div class="character-card" data-role="viewer">
            <div class="character-icon">üëÅÔ∏è</div>
            <div class="character-name">Observer</div>
            <div class="character-desc">Read-only monitoring</div>
          </div>
          
          <div class="character-card" data-role="admin">
            <div class="character-icon">‚öôÔ∏è</div>
            <div class="character-name">Administrator</div>
            <div class="character-desc">Full system control</div>
          </div>
        </div>
        
        <!-- Doctor Login / Register Form -->
        <div id="doctorLoginForm" style="display: none; margin-top: 28px;">
          <button id="backBtnDoctor" class="jarvis-btn jarvis-btn-secondary" style="width: 100%; margin-bottom: 20px;">‚Üê Return to Selection</button>

          <!-- Tab switcher -->
          <div style="display: flex; gap: 8px; margin-bottom: 24px;">
            <button id="showLoginTab" onclick="showDoctorTab('login')" class="jarvis-btn" style="flex:1;">üîë Login</button>
            <button id="showRegisterTab" onclick="showDoctorTab('register')" class="jarvis-btn" style="flex:1; background:#e9ecef; color:#546e7a;">üìù Register</button>
          </div>

          <!-- LOGIN TAB -->
          <div id="doctorLoginTab">
            <div class="form-group">
              <label>‚öïÔ∏è Select Your Name</label>
              <select id="doctorSelect">
                <option value="">-- Select your name --</option>
              </select>
            </div>
            <div class="form-group">
              <label>üîê Password</label>
              <input type="password" id="doctorPassword" placeholder="Enter your password">
            </div>
            <div class="error-msg" id="doctorError">‚ùå Wrong password. Please try again.</div>
            <button class="jarvis-btn" id="doctorLoginBtn" style="width: 100%;">Authenticate</button>
            <p style="color: #95a5a6; font-size: 11px; margin-top: 14px; text-align: center;">
              New here? Click <strong>Register</strong> above to create your account.
            </p>
          </div>

          <!-- REGISTER TAB -->
          <div id="doctorRegisterTab" style="display:none;">
            <div class="form-group">
              <label>‚öïÔ∏è Your Name</label>
              <input type="text" id="registerName" placeholder="e.g. Priya  (Dr. added automatically)">
            </div>
            <div class="form-group">
              <label>üîê Create Password</label>
              <input type="password" id="registerPassword" placeholder="Minimum 6 characters">
            </div>
            <div class="form-group">
              <label>üîê Confirm Password</label>
              <input type="password" id="registerConfirm" placeholder="Re-enter your password">
            </div>
            <div class="error-msg" id="registerError">‚ùå Error.</div>
            <div id="registerSuccess" style="display:none; color:#27ae60; background:#e8f5e9; padding:12px; border-radius:8px; font-size:13px; margin-bottom:12px; border:1px solid #81c784; text-align:center;">
              ‚úì Account created! Switch to Login tab to sign in.
            </div>
            <button class="jarvis-btn jarvis-btn-secondary" id="doctorRegisterBtn" style="width: 100%;">Create Account</button>
          </div>
        </div>

        <!-- Admin Login Form -->
        <div id="adminLoginForm" style="display: none; margin-top: 28px;">
          <button id="backBtnAdmin" class="jarvis-btn jarvis-btn-secondary" style="width: 100%; margin-bottom: 20px;">‚Üê Return to Selection</button>
          <div class="form-group">
            <label>‚öôÔ∏è Admin Username</label>
            <input type="text" id="adminUsername" placeholder="Enter admin username">
          </div>
          <div class="form-group">
            <label>üîê Admin Password</label>
            <input type="password" id="adminPassword" placeholder="Enter admin password">
          </div>
          <div class="error-msg" id="adminError">‚ùå Invalid admin credentials. Access denied.</div>
          <button class="jarvis-btn" id="adminLoginBtn" style="width: 100%;">Authenticate</button>
        </div>
      </div>
    </div>
  </div>

  <header>
    <div class="header-content">
      <div class="logo">
        <div class="logo-icon">‚óà</div>
        <div class="logo-text">
          <h1>A.I.S.H</h1>
          <p>AI Health Monitoring System</p>
        </div>
      </div>
      <div class="status" id="systemStatus">
        <div class="status-dot" id="statusDot"></div>
        <div class="status-text" id="statusText">Connecting...</div>
      </div>
      <div class="user-badge" id="userBadge">
        <span id="userIcon">‚óâ</span>
        <span id="userName">User</span>
        <button id="switchRoleBtn" style="background: none; border: none; color: #3498db; cursor: pointer; font-size: 18px; margin-left: 8px;" title="Switch Role">‚ü≤</button>
        <button id="logoutBtn" style="background: none; border: none; color: #e74c3c; cursor: pointer; font-size: 18px; margin-left: 8px;" title="Logout">‚äó</button>
      </div>
      <button class="download-btn" onclick="downloadDashboard()">
        üìä Download Dashboard
      </button>
      <button class="download-btn" onclick="downloadRegistry()">
        üìã Download Registry
      </button>
    </div>
  </header>

  <nav>
    <button class="nav-btn active" data-tab="dashboard">‚óà Dashboard</button>
    <button class="nav-btn" data-tab="report">‚äï Report Case</button>
    <button class="nav-btn" data-tab="water">‚âã Water Sources</button>
    <button class="nav-btn" data-tab="analytics">‚ó¨ Analytics</button>
    <button class="nav-btn" data-tab="protocols">‚öï Protocols</button>
    <button class="nav-btn" id="adminBtn" data-tab="admin" style="display: none;">‚öô Admin Panel</button>
  </nav>

  <main>
    <!-- Dashboard -->
    <div id="dashboard" class="section-visible">
      <div class="stats-grid">
        <div class="jarvis-panel stat-card">
          <div>
            <div class="stat-label">Total Cases</div>
            <div class="stat-value" id="totalCases">24</div>
            <div class="stat-subtext"><span id="activeCases">8</span> currently active</div>
          </div>
          <div class="stat-icon">‚óà</div>
        </div>
        <div class="jarvis-panel stat-card">
          <div>
            <div class="stat-label">Critical Status</div>
            <div class="stat-value" id="criticalCases">6</div>
            <div class="stat-subtext">Immediate attention required</div>
          </div>
          <div class="stat-icon">‚ö†</div>
        </div>
        <div class="jarvis-panel stat-card">
          <div>
            <div class="stat-label">Recovered</div>
            <div class="stat-value" id="recoveredCases">14</div>
            <div class="stat-subtext">Treatment completed</div>
          </div>
          <div class="stat-icon">‚úì</div>
        </div>
        <div class="jarvis-panel stat-card">
          <div>
            <div class="stat-label">Affected Areas</div>
            <div class="stat-value" id="affectedAreas">4</div>
            <div class="stat-subtext">High-risk zones identified</div>
          </div>
          <div class="stat-icon">‚ñ£</div>
        </div>
      </div>

      <div class="jarvis-panel">
        <h2>Case Registry</h2>
        <table>
          <thead>
            <tr>
              <th>Patient</th>
              <th>Location</th>
              <th>Symptoms</th>
              <th>Severity</th>
              <th>Status</th>
              <th>Date</th>
              <th id="actionsHeader" style="display: none;">Actions</th>
            </tr>
          </thead>
          <tbody id="caseTableBody">
            <tr class="default-case">
              <td><strong>Priya</strong><br><span style="color: #95a5a6;">Age: 28</span></td>
              <td>Imphal</td>
              <td><span class="symptom-badge">Vomiting</span><span class="symptom-badge">Abdominal Pain</span></td>
              <td><span class="severity-badge severity-high">Critical</span></td>
              <td><span style="color: #e74c3c; font-weight: 700;">Active</span></td>
              <td>Oct 16</td>
              <td></td>
            </tr>
            <tr class="default-case">
              <td><strong>Lakshmi</strong><br><span style="color: #95a5a6;">Age: 31</span></td>
              <td>Aizawl</td>
              <td><span class="symptom-badge">Fever</span><span class="symptom-badge">Nausea</span></td>
              <td><span class="severity-badge severity-high">Critical</span></td>
              <td><span style="color: #e74c3c; font-weight: 700;">Active</span></td>
              <td>Oct 17</td>
              <td></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Report Case -->
    <div id="report" class="section-hidden">

      <!-- Observer blocked message -->
      <div id="reportBlockedMessage" style="display:none;">
        <div class="jarvis-panel">
          <div class="observer-blocked">
            <div class="blocked-icon">üîí</div>
            <h3>Access Restricted</h3>
            <p>Observers cannot report cases.<br>This feature is only available for <strong>Medical Officers</strong> and <strong>Administrators</strong>.</p>
            <button class="jarvis-btn" onclick="document.getElementById('logoutBtn').click()">Switch to Medical Officer Login</button>
          </div>
        </div>
      </div>

      <!-- Actual report form (hidden for observers) -->
      <div id="reportFormContainer" style="max-width: 900px; margin: 0 auto;">
        <div class="jarvis-panel">
          <h2 style="font-size: 24px; margin-bottom: 10px;">‚äï New Case Report</h2>
          <p style="color: #7f8c8d; margin-bottom: 16px; font-size: 13px;">Enter patient information and symptoms</p>
          
          <form id="reportForm">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
              <div class="form-group">
                <label>Patient Name *</label>
                <input type="text" id="patientName" required placeholder="Enter full name">
              </div>
              <div class="form-group">
                <label>Age *</label>
                <input type="number" id="patientAge" required placeholder="Age" min="0" max="120">
              </div>
            </div>
            <div class="form-group">
              <label>Location *</label>
              <input type="text" id="patientLocation" required placeholder="City or village">
              <button type="button" class="location-detect-btn" id="detectLocationBtn" onclick="detectLocation()">
                üìç Detect My Location
              </button>
              <div class="location-info" id="locationInfo"></div>
              <input type="hidden" id="patientLat">
              <input type="hidden" id="patientLng">
            </div>
            <div class="form-group">
              <label>Symptoms (Select all applicable) *</label>
              <div class="symptom-grid" id="symptomGrid">
                <button type="button" class="symptom-btn" data-symptom="Diarrhea">Diarrhea</button>
                <button type="button" class="symptom-btn" data-symptom="Vomiting">Vomiting</button>
                <button type="button" class="symptom-btn" data-symptom="Fever">Fever</button>
                <button type="button" class="symptom-btn" data-symptom="Abdominal Pain">Abd. Pain</button>
                <button type="button" class="symptom-btn" data-symptom="Nausea">Nausea</button>
                <button type="button" class="symptom-btn" data-symptom="Dehydration">Dehydration</button>
              </div>
              <input type="hidden" id="selectedSymptoms" value="">
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
              <div class="form-group">
                <label>Water Source *</label>
                <select id="waterSource" required>
                  <option value="">Select source</option>
                  <option value="Well">Well</option>
                  <option value="River">River</option>
                  <option value="Pond">Pond</option>
                  <option value="Tap Water">Tap Water</option>
                  <option value="Rainwater">Rainwater</option>
                </select>
              </div>
              <div class="form-group">
                <label>Severity Level</label>
                <select id="severity">
                  <option value="low">Low</option>
                  <option value="medium">Medium</option>
                  <option value="high">Critical</option>
                </select>
              </div>
            </div>
            <button type="submit" class="jarvis-btn" style="width: 100%; margin-top: 12px;">Submit Report</button>
          </form>
        </div>
      </div><!-- end reportFormContainer -->
    </div>

    <!-- Water Sources -->
    <div id="water" class="section-hidden">
      <h2 style="font-size: 24px; margin-bottom: 28px;">‚âã Water Source Monitoring</h2>
      <div class="jarvis-panel">
        <h2>Geographic Distribution</h2>
        <div id="map"></div>
      </div>
    </div>

    <!-- Analytics -->
    <div id="analytics" class="section-hidden">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 28px; flex-wrap: wrap; gap: 16px;">
        <div>
          <h2 style="font-size: 24px; margin-bottom: 8px;">‚ó¨ AI Analytics Engine</h2>
          <p style="font-size: 13px; color: #7f8c8d;">Real-time analysis from live database</p>
        </div>
        <div class="ai-badge">AI-Powered Predictions</div>
      </div>

      <!-- AI Insights Cards ‚Äî filled by updateAnalytics() -->
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 28px;">
        <div class="protocol-card" id="riskCard" style="background: linear-gradient(135deg, #ffebee 0%, #ffffff 100%);">
          <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 16px;">
            <div>
              <div style="font-family: 'Poppins', sans-serif; font-size: 11px; color: #7f8c8d; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px;">Risk Level</div>
              <div id="riskLevel" style="font-family: 'Poppins', sans-serif; font-size: 32px; color: #e74c3c; font-weight: 700;">‚Äî</div>
            </div>
            <div style="font-size: 48px; opacity: 0.6; animation: pulse 2s ease-in-out infinite;">‚ö†Ô∏è</div>
          </div>
          <div id="riskDesc" style="font-size: 13px; color: #546e7a; line-height: 1.6;">Loading...</div>
        </div>

        <div class="protocol-card" style="background: linear-gradient(135deg, #e8f5e9 0%, #ffffff 100%);">
          <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 16px;">
            <div>
              <div style="font-family: 'Poppins', sans-serif; font-size: 11px; color: #7f8c8d; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px;">Next Week Forecast</div>
              <div id="forecastNum" style="font-family: 'Poppins', sans-serif; font-size: 32px; color: #27ae60; font-weight: 700;">‚Äî</div>
            </div>
            <div style="font-size: 48px; opacity: 0.6; animation: pulse 2s ease-in-out infinite;">üìà</div>
          </div>
          <div id="forecastDesc" style="font-size: 13px; color: #546e7a; line-height: 1.6;">Loading...</div>
        </div>

        <div class="protocol-card" style="background: linear-gradient(135deg, #fff3e0 0%, #ffffff 100%);">
          <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 16px;">
            <div>
              <div style="font-family: 'Poppins', sans-serif; font-size: 11px; color: #7f8c8d; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px;">Top Risk Factor</div>
              <div id="topRiskFactor" style="font-family: 'Poppins', sans-serif; font-size: 20px; color: #f57c00; font-weight: 700;">‚Äî</div>
            </div>
            <div style="font-size: 48px; opacity: 0.6; animation: pulse 2s ease-in-out infinite;">ü™£</div>
          </div>
          <div id="topRiskDesc" style="font-size: 13px; color: #546e7a; line-height: 1.6;">Loading...</div>
        </div>
      </div>

      <!-- Chart Section -->
      <div class="jarvis-panel">
        <h2>Case Trend Analysis</h2>
        <div class="chart-container">
          <canvas id="trendChart"></canvas>
        </div>
        <div style="margin-top: 20px; padding: 16px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #3498db;">
          <div style="font-family: 'Poppins', sans-serif; font-size: 11px; color: #7f8c8d; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px;">
            ü§ñ AI Analysis
          </div>
          <div id="aiAnalysisText" style="font-size: 14px; color: #2c3e50; line-height: 1.6;">Loading analysis...</div>
        </div>
      </div>

      <!-- Geographic Heat Analysis ‚Äî filled by updateAnalytics() -->
      <div class="jarvis-panel" style="margin-top: 28px;">
        <h2 style="margin-bottom: 20px;">Geographic Heat Analysis</h2>
        <div id="heatGrid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
          <div style="text-align:center; color:#95a5a6; padding:32px; font-family:'Poppins',sans-serif; grid-column:1/-1;">
            Loading location data...
          </div>
        </div>
        <div style="margin-top: 24px; padding: 20px; background: linear-gradient(135deg, #e3f2fd 0%, #e8f5e9 100%); border-radius: 12px; border: 1px solid #90caf9;">
          <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
            <div style="font-size: 32px; animation: float 3s ease-in-out infinite;">ü§ñ</div>
            <div style="font-family: 'Poppins', sans-serif; font-size: 14px; color: #2c3e50; font-weight: 700;">AI Recommendation</div>
          </div>
          <div id="aiRecommendation" style="font-size: 14px; color: #546e7a; line-height: 1.6;">Loading recommendations...</div>
        </div>
      </div>
    </div>

    <!-- Protocols -->
    <div id="protocols" class="section-hidden">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 28px; flex-wrap: wrap; gap: 16px;">
        <div>
          <h2 style="font-size: 24px; margin-bottom: 8px;">ü§ñ AI Health Protocols</h2>
          <p style="font-size: 13px; color: #7f8c8d;">Powered by AISH Intelligence Engine</p>
        </div>
        <div class="language-selector">
          <button class="language-btn active" onclick="changeLanguage('english')">English</button>
          <button class="language-btn" onclick="changeLanguage('tamil')">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</button>
          <button class="language-btn" onclick="changeLanguage('malayalam')">‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç</button>
          <button class="language-btn" onclick="changeLanguage('hindi')">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</button>
          <button class="language-btn" onclick="changeLanguage('bengali')">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ</button>
        </div>
      </div>
      <div class="jarvis-panel">
        <div id="protocolsContent"></div>
      </div>
    </div>

    <!-- Admin Panel -->
    <div id="admin" class="section-hidden">
      <div class="jarvis-panel">
        <h2>‚öôÔ∏è System Administration</h2>
        <p style="color: #7f8c8d; margin-bottom: 24px; font-size: 13px;">Administrator privileges active. You can manage cases from the Case Registry.</p>
        
        <div class="security-note">
          <strong>üîí Security Note:</strong>
          <p>All delete actions require explicit confirmation and are logged for audit purposes. Case deletions are permanent and cannot be undone.</p>
        </div>

        <div style="margin-top: 24px; padding: 20px; background: #e8f5e9; border-left: 4px solid #27ae60; border-radius: 8px;">
          <strong style="color: #27ae60; font-family: 'Poppins', sans-serif; font-size: 14px;">‚úì Active Admin Session</strong>
          <p style="color: #7f8c8d; margin-top: 8px; font-size: 13px;">You have full access to edit and delete cases. Navigate to the Dashboard to manage the Case Registry.</p>
        </div>
      </div>
    </div>
  </main>

  <!-- Floating Chatbot Toggle Button -->
  <button class="chatbot-toggle" id="chatbotToggle" onclick="toggleChatbot()">
    ü§ñ
  </button>

  <!-- Floating Chatbot Popup -->
  <div class="chatbot-popup" id="chatbotPopup">
    <div class="chatbot-header">
      <h3>ü§ñ AISH Health Assistant</h3>
      <button class="chatbot-close" onclick="toggleChatbot()">‚úï</button>
    </div>
    
    <div class="chatbot-body">
      <div style="text-align: center; margin-bottom: 20px;">
        <div class="ai-badge" style="display: inline-block;">‚ö° AI ACTIVE</div>
        <p style="color: #7f8c8d; font-size: 13px; margin-top: 8px;">Multilingual AI-Powered Health Support</p>
      </div>

      <div style="margin-bottom: 16px;">
        <label style="font-weight: 600; color: #2c3e50; font-size: 12px; margin-bottom: 8px; display: block;">Select Language:</label>
        <div class="language-selector" style="display: flex; flex-wrap: wrap; gap: 6px;">
          <button class="language-btn active" id="chatLangEn" onclick="setChatLanguage('en')" style="padding: 6px 12px; font-size: 11px;">English</button>
          <button class="language-btn" id="chatLangHi" onclick="setChatLanguage('hi')" style="padding: 6px 12px; font-size: 11px;">‡§π‡§ø‡§Ç‡§¶‡•Ä</button>
          <button class="language-btn" id="chatLangTa" onclick="setChatLanguage('ta')" style="padding: 6px 12px; font-size: 11px;">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</button>
          <button class="language-btn" id="chatLangTe" onclick="setChatLanguage('te')" style="padding: 6px 12px; font-size: 11px;">‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</button>
          <button class="language-btn" id="chatLangBn" onclick="setChatLanguage('bn')" style="padding: 6px 12px; font-size: 11px;">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ</button>
        </div>
      </div>

      <div id="chatMessages" style="background: #ffffff; border-radius: 12px; padding: 16px; height: 300px; overflow-y: auto; margin-bottom: 16px; border: 1px solid #e9ecef;">
        <div class="chat-message bot-message" style="margin-bottom: 12px; padding: 12px; background: #e3f2fd; border-radius: 12px; border-left: 4px solid #3498db;">
          <div style="font-weight: 600; color: #3498db; margin-bottom: 6px; font-size: 12px;">ü§ñ AISH Assistant</div>
          <div style="color: #2c3e50; font-size: 13px; line-height: 1.5;">Hello! I'm AISH, your health monitoring assistant. I can help you with:<br><br>
            ‚Ä¢ Understanding waterborne diseases<br>
            ‚Ä¢ Prevention guidelines<br>
            ‚Ä¢ Treatment protocols<br>
            ‚Ä¢ Symptom identification<br>
            ‚Ä¢ Emergency contacts<br><br>
            How can I assist you today?
          </div>
        </div>
      </div>

      <div style="margin-bottom: 16px; padding: 12px; background: #fff3cd; border-left: 3px solid #ffc107; border-radius: 8px;">
        <div style="font-weight: 600; color: #856404; font-size: 11px; margin-bottom: 8px;">üí° Quick Topics</div>
        <div style="display: flex; flex-wrap: wrap; gap: 6px;">
          <button class="quick-topic-btn" onclick="askQuickQuestion('What is cholera?')" style="padding: 6px 12px; font-size: 11px;">Cholera</button>
          <button class="quick-topic-btn" onclick="askQuickQuestion('How to prevent waterborne diseases?')" style="padding: 6px 12px; font-size: 11px;">Prevention</button>
          <button class="quick-topic-btn" onclick="askQuickQuestion('What are symptoms of typhoid?')" style="padding: 6px 12px; font-size: 11px;">Typhoid</button>
          <button class="quick-topic-btn" onclick="askQuickQuestion('Emergency contacts')" style="padding: 6px 12px; font-size: 11px;">Emergency</button>
        </div>
      </div>
    </div>
    
    <div class="chatbot-footer">
      <div style="display: flex; gap: 8px;">
        <input type="text" id="chatInput" placeholder="Type your health question..." style="flex: 1; padding: 10px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 13px; font-family: 'Inter', sans-serif;" onkeypress="if(event.key==='Enter') sendChatMessage()">
        <button onclick="sendChatMessage()" style="padding: 10px 20px; background: linear-gradient(135deg, #3498db 0%, #2980b9 100%); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 13px; transition: all 0.3s ease; font-family: 'Poppins', sans-serif;">Send</button>
      </div>
    </div>
  </div>

  <!-- Edit Case Modal -->
  <div id="editCaseModal" class="modal">
    <div class="modal-content">
      <div class="jarvis-panel">
        <h2 style="font-size: 24px; margin-bottom: 20px; text-align: center;">‚úèÔ∏è Edit Case</h2>
        <form id="editCaseForm">
          <div style="margin-bottom: 16px;">
            <label style="font-weight: 600; color: #2c3e50; font-size: 13px; margin-bottom: 8px; display: block;">Patient Name:</label>
            <input type="text" id="editPatientName" required style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 14px; font-family: 'Inter', sans-serif;">
          </div>

          <div style="margin-bottom: 16px;">
            <label style="font-weight: 600; color: #2c3e50; font-size: 13px; margin-bottom: 8px; display: block;">Age:</label>
            <input type="number" id="editPatientAge" required style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 14px; font-family: 'Inter', sans-serif;">
          </div>

          <div style="margin-bottom: 16px;">
            <label style="font-weight: 600; color: #2c3e50; font-size: 13px; margin-bottom: 8px; display: block;">Location:</label>
            <input type="text" id="editPatientLocation" required style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 14px; font-family: 'Inter', sans-serif;">
          </div>

          <div style="margin-bottom: 16px;">
            <label style="font-weight: 600; color: #2c3e50; font-size: 13px; margin-bottom: 8px; display: block;">Symptoms:</label>
            <textarea id="editPatientSymptoms" required rows="3" style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 14px; font-family: 'Inter', sans-serif; resize: vertical;"></textarea>
          </div>

          <div style="margin-bottom: 16px;">
            <label style="font-weight: 600; color: #2c3e50; font-size: 13px; margin-bottom: 8px; display: block;">Water Source:</label>
            <select id="editWaterSource" required style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 14px; font-family: 'Inter', sans-serif;">
              <option value="Well">Well</option>
              <option value="River">River</option>
              <option value="Pond">Pond</option>
              <option value="Municipal">Municipal Supply</option>
              <option value="Borewell">Borewell</option>
              <option value="Other">Other</option>
            </select>
          </div>

          <div style="margin-bottom: 16px;">
            <label style="font-weight: 600; color: #2c3e50; font-size: 13px; margin-bottom: 8px; display: block;">Severity:</label>
            <select id="editSeverity" required style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 14px; font-family: 'Inter', sans-serif;">
              <option value="low">Low</option>
              <option value="medium">Medium</option>
              <option value="high">High</option>
            </select>
          </div>

          <div style="margin-bottom: 20px;">
            <label style="font-weight: 600; color: #2c3e50; font-size: 13px; margin-bottom: 8px; display: block;">Status:</label>
            <select id="editStatus" required style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 14px; font-family: 'Inter', sans-serif;">
              <option value="Active">Active</option>
              <option value="Recovered">Recovered</option>
              <option value="Under Treatment">Under Treatment</option>
            </select>
          </div>

          <div style="display: flex; gap: 12px;">
            <button type="submit" class="jarvis-btn jarvis-btn-primary" style="flex: 1;">üíæ Save Changes</button>
            <button type="button" onclick="closeEditModal()" class="jarvis-btn jarvis-btn-secondary" style="flex: 1;">‚ùå Cancel</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script>
    let currentUser = null;
    let cases = [];
    let map = null;
    let chart = null;
    let isOnline = navigator.onLine;
    let currentLanguage = 'english';
    let userMarkers = []; // Store user-added markers
    let syncQueue = []; // Queue for offline data

    // Firebase-like configuration (using localStorage as fallback)
    const FIREBASE_CONFIG = {
      apiKey: "demo-key",
      projectId: "aish-health-monitoring"
    };

    const translations = {
      english: {
        greeting: "Hello! I'm Dr. AISH, your AI health assistant.",
        doTitle: "What You SHOULD Do",
        dontTitle: "What You SHOULD NOT Do",
        dos: [
          "Always boil water for at least 1 minute before drinking",
          "Wash your hands with soap for 20 seconds before eating",
          "Store drinking water in clean, covered containers",
          "Report symptoms within 24 hours of onset",
          "Use oral rehydration solution (ORS) if experiencing diarrhea",
          "Seek immediate medical attention for severe symptoms"
        ],
        donts: [
          "Never drink untreated water from unknown sources",
          "Don't share utensils or cups with infected individuals",
          "Avoid consuming raw or undercooked food",
          "Don't ignore persistent gastrointestinal symptoms",
          "Never handle food when experiencing vomiting or diarrhea",
          "Don't swim in contaminated water bodies"
        ],
        tip: "Remember: Prevention is better than cure! Stay hydrated and maintain good hygiene."
      },
      tamil: {
        greeting: "‡Æµ‡Æ£‡Æï‡Øç‡Æï‡ÆÆ‡Øç! ‡Æ®‡Ææ‡Æ©‡Øç ‡Æü‡Ææ‡Æï‡Øç‡Æü‡Æ∞‡Øç AISH, ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç AI ‡Æö‡ØÅ‡Æï‡Ææ‡Æ§‡Ææ‡Æ∞ ‡Æâ‡Æ§‡Æµ‡Æø‡ÆØ‡Ææ‡Æ≥‡Æ∞‡Øç.",
        doTitle: "‡Æ®‡ØÄ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æö‡ØÜ‡ÆØ‡Øç‡ÆØ ‡Æµ‡Øá‡Æ£‡Øç‡Æü‡Æø‡ÆØ‡Æµ‡Øà",
        dontTitle: "‡Æ®‡ØÄ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æö‡ØÜ‡ÆØ‡Øç‡ÆØ‡Æï‡Øç‡Æï‡ØÇ‡Æü‡Ææ‡Æ§‡Æµ‡Øà",
        dos: [
          "‡Æï‡ØÅ‡Æü‡Æø‡Æ™‡Øç‡Æ™‡Æ§‡Æ±‡Øç‡Æï‡ØÅ ‡ÆÆ‡ØÅ‡Æ©‡Øç ‡Æï‡ØÅ‡Æ±‡Øà‡Æ®‡Øç‡Æ§‡Æ§‡ØÅ 1 ‡Æ®‡Æø‡ÆÆ‡Æø‡Æü‡ÆÆ‡Øç ‡Æ§‡Æ£‡Øç‡Æ£‡ØÄ‡Æ∞‡Øà ‡Æï‡Øä‡Æ§‡Æø‡Æï‡Øç‡Æï ‡Æµ‡Øà‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç",
          "‡Æâ‡Æ£‡Æµ‡ØÅ ‡Æâ‡Æ£‡Øç‡Æ™‡Æ§‡Æ±‡Øç‡Æï‡ØÅ ‡ÆÆ‡ØÅ‡Æ©‡Øç 20 ‡Æµ‡Æø‡Æ®‡Ææ‡Æü‡Æø‡Æï‡Æ≥‡Øç ‡Æö‡Øã‡Æ™‡Øç‡Æ™‡Ææ‡Æ≤‡Øç ‡Æï‡Øà‡Æï‡Æ≥‡Øà ‡Æï‡Æ¥‡ØÅ‡Æµ‡Æµ‡ØÅ‡ÆÆ‡Øç",
          "‡Æï‡ØÅ‡Æü‡Æø‡Æ®‡ØÄ‡Æ∞‡Øà ‡Æö‡ØÅ‡Æ§‡Øç‡Æ§‡ÆÆ‡Ææ‡Æ© ‡ÆÆ‡ØÇ‡Æü‡Æø‡ÆØ ‡Æ™‡Ææ‡Æ§‡Øç‡Æ§‡Æø‡Æ∞‡Æô‡Øç‡Æï‡Æ≥‡Æø‡Æ≤‡Øç ‡Æö‡Øá‡ÆÆ‡Æø‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç",
          "‡ÆÖ‡Æ±‡Æø‡Æï‡ØÅ‡Æ±‡Æø‡Æï‡Æ≥‡Øç ‡Æ§‡Øã‡Æ©‡Øç‡Æ±‡Æø‡ÆØ 24 ‡ÆÆ‡Æ£‡Æø ‡Æ®‡Øá‡Æ∞‡Æ§‡Øç‡Æ§‡Æø‡Æ±‡Øç‡Æï‡ØÅ‡Æ≥‡Øç ‡Æ™‡ØÅ‡Æï‡Ææ‡Æ∞‡Æ≥‡Æø‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç",
          "‡Æµ‡ÆØ‡Æø‡Æ±‡Øç‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Øã‡Æï‡Øç‡Æï‡ØÅ ‡Æè‡Æ±‡Øç‡Æ™‡Æü‡Øç‡Æü‡Ææ‡Æ≤‡Øç ORS ‡Æï‡Æ∞‡Øà‡Æö‡Æ≤‡Øà ‡Æ™‡ÆØ‡Æ©‡Øç‡Æ™‡Æü‡ØÅ‡Æ§‡Øç‡Æ§‡Æµ‡ØÅ‡ÆÆ‡Øç",
          "‡Æï‡Æü‡ØÅ‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ© ‡ÆÖ‡Æ±‡Æø‡Æï‡ØÅ‡Æ±‡Æø‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ ‡Æâ‡Æü‡Æ©‡Æü‡Æø‡ÆØ‡Ææ‡Æï ‡ÆÆ‡Æ∞‡ØÅ‡Æ§‡Øç‡Æ§‡ØÅ‡Æµ ‡Æâ‡Æ§‡Æµ‡Æø ‡Æ™‡ØÜ‡Æ±‡Æµ‡ØÅ‡ÆÆ‡Øç"
        ],
        donts: [
          "‡Æ§‡ØÜ‡Æ∞‡Æø‡ÆØ‡Ææ‡Æ§ ‡ÆÜ‡Æ§‡Ææ‡Æ∞‡Æô‡Øç‡Æï‡Æ≥‡Æø‡Æ≤‡Æø‡Æ∞‡ØÅ‡Æ®‡Øç‡Æ§‡ØÅ ‡Æö‡ØÅ‡Æ§‡Øç‡Æ§‡Æø‡Æï‡Æ∞‡Æø‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Ææ‡Æ§ ‡Æ§‡Æ£‡Øç‡Æ£‡ØÄ‡Æ∞‡Øà ‡Æï‡ØÅ‡Æü‡Æø‡Æï‡Øç‡Æï‡Ææ‡Æ§‡ØÄ‡Æ∞‡Øç‡Æï‡Æ≥‡Øç",
          "‡Æ®‡Øã‡ÆØ‡ØÅ‡Æ±‡Øç‡Æ± ‡Æâ‡Æ≥‡Øç‡Æ≥‡Æµ‡Æ∞‡Øç‡Æï‡Æ≥‡ØÅ‡Æü‡Æ©‡Øç ‡Æ™‡Ææ‡Æ§‡Øç‡Æ§‡Æø‡Æ∞‡Æô‡Øç‡Æï‡Æ≥‡Øà ‡Æ™‡Æï‡Æø‡Æ∞‡Øç‡Æ®‡Øç‡Æ§‡ØÅ ‡Æï‡Øä‡Æ≥‡Øç‡Æ≥‡Ææ‡Æ§‡ØÄ‡Æ∞‡Øç‡Æï‡Æ≥‡Øç",
          "‡Æ™‡Æö‡Øç‡Æö‡Øà ‡ÆÖ‡Æ≤‡Øç‡Æ≤‡Æ§‡ØÅ ‡ÆÆ‡ØÅ‡Æ¥‡ØÅ‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æï ‡Æö‡ÆÆ‡Øà‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Ææ‡Æ§ ‡Æâ‡Æ£‡Æµ‡Øà ‡Æâ‡Æ£‡Øç‡Æ£‡Ææ‡Æ§‡ØÄ‡Æ∞‡Øç‡Æï‡Æ≥‡Øç",
          "‡Æ§‡Øä‡Æü‡Æ∞‡Øç‡Æö‡Øç‡Æö‡Æø‡ÆØ‡Ææ‡Æ© ‡Æµ‡ÆØ‡Æø‡Æ±‡ØÅ ‡ÆÖ‡Æ±‡Æø‡Æï‡ØÅ‡Æ±‡Æø‡Æï‡Æ≥‡Øà ‡Æ™‡ØÅ‡Æ±‡Æï‡Øç‡Æï‡Æ£‡Æø‡Æï‡Øç‡Æï‡Ææ‡Æ§‡ØÄ‡Æ∞‡Øç‡Æï‡Æ≥‡Øç",
          "‡Æµ‡Ææ‡Æ®‡Øç‡Æ§‡Æø ‡ÆÖ‡Æ≤‡Øç‡Æ≤‡Æ§‡ØÅ ‡Æµ‡ÆØ‡Æø‡Æ±‡Øç‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Øã‡Æï‡Øç‡Æï‡ØÅ ‡Æá‡Æ∞‡ØÅ‡Æï‡Øç‡Æï‡ØÅ‡ÆÆ‡Øç‡Æ™‡Øã‡Æ§‡ØÅ ‡Æâ‡Æ£‡Æµ‡ØÅ ‡Æ§‡ÆØ‡Ææ‡Æ∞‡Æø‡Æï‡Øç‡Æï‡Ææ‡Æ§‡ØÄ‡Æ∞‡Øç‡Æï‡Æ≥‡Øç",
          "‡ÆÆ‡Ææ‡Æö‡ØÅ‡Æ™‡Æü‡Øç‡Æü ‡Æ®‡ØÄ‡Æ∞‡Øç‡Æ®‡Æø‡Æ≤‡Øà‡Æï‡Æ≥‡Æø‡Æ≤‡Øç ‡Æ®‡ØÄ‡Æ®‡Øç‡Æ§‡Ææ‡Æ§‡ØÄ‡Æ∞‡Øç‡Æï‡Æ≥‡Øç"
        ],
        tip: "‡Æ®‡Æø‡Æ©‡Øà‡Æµ‡Æø‡Æ≤‡Øç ‡Æï‡Øä‡Æ≥‡Øç‡Æ≥‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç: ‡Æ§‡Æü‡ØÅ‡Æ™‡Øç‡Æ™‡ØÅ ‡Æö‡Æø‡Æï‡Æø‡Æö‡Øç‡Æö‡Øà‡ÆØ‡Øà ‡Æµ‡Æø‡Æü ‡Æö‡Æø‡Æ±‡Æ®‡Øç‡Æ§‡Æ§‡ØÅ! ‡Æ®‡ØÄ‡Æ∞‡Øá‡Æ±‡Øç‡Æ±‡ÆÆ‡Ææ‡Æï ‡Æá‡Æ∞‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡Æ®‡Æ≤‡Øç‡Æ≤ ‡Æö‡ØÅ‡Æï‡Ææ‡Æ§‡Ææ‡Æ∞‡Æ§‡Øç‡Æ§‡Øà ‡Æ™‡Øá‡Æ£‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç."
      },
      malayalam: {
        greeting: "‡¥π‡¥≤‡µã! ‡¥û‡¥æ‡µª ‡¥°‡µã. AISH, ‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ AI ‡¥Ü‡¥∞‡µã‡¥ó‡µç‡¥Ø ‡¥∏‡¥π‡¥æ‡¥Ø‡¥ø.",
        doTitle: "‡¥®‡¥ø‡¥ô‡µç‡¥ô‡µæ ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µá‡¥£‡µç‡¥ü‡¥µ",
        dontTitle: "‡¥®‡¥ø‡¥ô‡µç‡¥ô‡µæ ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡¥∞‡µÅ‡¥§‡¥æ‡¥§‡µç‡¥§‡¥µ",
        dos: [
          "‡¥ï‡µÅ‡¥ü‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡¥§‡¥ø‡¥®‡µÅ ‡¥Æ‡µÅ‡¥Æ‡µç‡¥™‡µç ‡¥ï‡µÅ‡¥±‡¥û‡µç‡¥û‡¥§‡µç 1 ‡¥Æ‡¥ø‡¥®‡¥ø‡¥±‡µç‡¥±‡µç ‡¥µ‡µÜ‡¥≥‡µç‡¥≥‡¥Ç ‡¥§‡¥ø‡¥≥‡¥™‡µç‡¥™‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï",
          "‡¥≠‡¥ï‡µç‡¥∑‡¥£‡¥Ç ‡¥ï‡¥¥‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡¥§‡¥ø‡¥®‡µÅ ‡¥Æ‡µÅ‡¥Æ‡µç‡¥™‡µç 20 ‡¥∏‡µÜ‡¥ï‡µç‡¥ï‡µª‡¥°‡µç ‡¥∏‡µã‡¥™‡µç‡¥™‡µç ‡¥â‡¥™‡¥Ø‡µã‡¥ó‡¥ø‡¥ö‡µç‡¥ö‡µç ‡¥ï‡µà ‡¥ï‡¥¥‡µÅ‡¥ï‡µç‡¥ï‡µÅ‡¥ï",
          "‡¥ï‡µÅ‡¥ü‡¥ø‡¥µ‡µÜ‡¥≥‡µç‡¥≥‡¥Ç ‡¥µ‡µÉ‡¥§‡µç‡¥§‡¥ø‡¥Ø‡µÅ‡¥≥‡µç‡¥≥ ‡¥Æ‡µÇ‡¥ü‡¥ø‡¥Ø ‡¥™‡¥æ‡¥§‡µç‡¥∞‡¥ô‡µç‡¥ô‡¥≥‡¥ø‡µΩ ‡¥∏‡µÇ‡¥ï‡µç‡¥∑‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï",
          "‡¥≤‡¥ï‡µç‡¥∑‡¥£‡¥ô‡µç‡¥ô‡µæ ‡¥™‡µç‡¥∞‡¥§‡µç‡¥Ø‡¥ï‡µç‡¥∑‡¥™‡µç‡¥™‡µÜ‡¥ü‡µç‡¥ü‡µç 24 ‡¥Æ‡¥£‡¥ø‡¥ï‡µç‡¥ï‡µÇ‡¥±‡¥ø‡¥®‡µÅ‡¥≥‡µç‡¥≥‡¥ø‡µΩ ‡¥±‡¥ø‡¥™‡µç‡¥™‡µã‡µº‡¥ü‡µç‡¥ü‡µç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥ï",
          "‡¥µ‡¥Ø‡¥±‡¥ø‡¥≥‡¥ï‡µç‡¥ï‡¥Ç ‡¥â‡¥£‡µç‡¥ü‡µÜ‡¥ô‡µç‡¥ï‡¥ø‡µΩ ORS ‡¥≤‡¥æ‡¥Ø‡¥®‡¥ø ‡¥â‡¥™‡¥Ø‡µã‡¥ó‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï",
          "‡¥ó‡µÅ‡¥∞‡µÅ‡¥§‡¥∞‡¥Æ‡¥æ‡¥Ø ‡¥≤‡¥ï‡µç‡¥∑‡¥£‡¥ô‡µç‡¥ô‡µæ‡¥ï‡µç‡¥ï‡µç ‡¥â‡¥ü‡µª ‡¥µ‡µà‡¥¶‡µç‡¥Ø‡¥∏‡¥π‡¥æ‡¥Ø‡¥Ç ‡¥§‡µá‡¥ü‡µÅ‡¥ï"
        ],
        donts: [
          "‡¥Ö‡¥ú‡µç‡¥û‡¥æ‡¥§ ‡¥∏‡µç‡¥∞‡µã‡¥§‡¥∏‡µç‡¥∏‡µÅ‡¥ï‡¥≥‡¥ø‡µΩ ‡¥®‡¥ø‡¥®‡µç‡¥®‡µç ‡¥∂‡µÅ‡¥¶‡µç‡¥ß‡µÄ‡¥ï‡¥∞‡¥ø‡¥ï‡µç‡¥ï‡¥æ‡¥§‡µç‡¥§ ‡¥µ‡µÜ‡¥≥‡µç‡¥≥‡¥Ç ‡¥ï‡µÅ‡¥ü‡¥ø‡¥ï‡µç‡¥ï‡¥∞‡µÅ‡¥§‡µç",
          "‡¥∞‡µã‡¥ó‡¥¨‡¥æ‡¥ß‡¥ø‡¥§‡¥∞‡µÅ‡¥Æ‡¥æ‡¥Ø‡¥ø ‡¥™‡¥æ‡¥§‡µç‡¥∞‡¥ô‡µç‡¥ô‡µæ ‡¥™‡¥ô‡µç‡¥ï‡¥ø‡¥ü‡¥∞‡µÅ‡¥§‡µç",
          "‡¥Ö‡¥∏‡¥Ç‡¥∏‡µç‡¥ï‡µÉ‡¥§‡¥Æ‡µã ‡¥Ö‡¥≤‡µç‡¥≤‡µÜ‡¥ô‡µç‡¥ï‡¥ø‡µΩ ‡¥™‡¥æ‡¥ï‡¥Ç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡¥æ‡¥§‡µç‡¥§ ‡¥≠‡¥ï‡µç‡¥∑‡¥£‡¥Ç ‡¥ï‡¥¥‡¥ø‡¥ï‡µç‡¥ï‡¥∞‡µÅ‡¥§‡µç",
          "‡¥§‡µÅ‡¥ü‡µº‡¥ö‡µç‡¥ö‡¥Ø‡¥æ‡¥Ø ‡¥¶‡¥π‡¥®‡¥∏‡¥Ç‡¥¨‡¥®‡µç‡¥ß‡¥Æ‡¥æ‡¥Ø ‡¥≤‡¥ï‡µç‡¥∑‡¥£‡¥ô‡µç‡¥ô‡µæ ‡¥Ö‡¥µ‡¥ó‡¥£‡¥ø‡¥ï‡µç‡¥ï‡¥∞‡µÅ‡¥§‡µç",
          "‡¥õ‡µº‡¥¶‡µç‡¥¶‡¥ø ‡¥Ö‡¥≤‡µç‡¥≤‡µÜ‡¥ô‡µç‡¥ï‡¥ø‡µΩ ‡¥µ‡¥Ø‡¥±‡¥ø‡¥≥‡¥ï‡µç‡¥ï‡¥Ç ‡¥Ö‡¥®‡µÅ‡¥≠‡¥µ‡¥™‡µç‡¥™‡µÜ‡¥ü‡µÅ‡¥Æ‡µç‡¥™‡µã‡µæ ‡¥≠‡¥ï‡µç‡¥∑‡¥£‡¥Ç ‡¥ï‡µà‡¥ï‡¥æ‡¥∞‡µç‡¥Ø‡¥Ç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡¥∞‡µÅ‡¥§‡µç",
          "‡¥Æ‡¥≤‡¥ø‡¥®‡¥Æ‡¥æ‡¥Ø ‡¥ú‡¥≤‡¥æ‡¥∂‡¥Ø‡¥ô‡µç‡¥ô‡¥≥‡¥ø‡µΩ ‡¥®‡µÄ‡¥®‡µç‡¥§‡¥∞‡µÅ‡¥§‡µç"
        ],
        tip: "‡¥ì‡µº‡¥ï‡µç‡¥ï‡µÅ‡¥ï: ‡¥™‡µç‡¥∞‡¥§‡¥ø‡¥∞‡µã‡¥ß‡¥Ç ‡¥ö‡¥ø‡¥ï‡¥ø‡¥§‡µç‡¥∏‡¥Ø‡µá‡¥ï‡µç‡¥ï‡¥æ‡µæ ‡¥®‡¥≤‡µç‡¥≤‡¥§‡µç! ‡¥ú‡¥≤‡¥æ‡¥Ç‡¥∂‡¥Ç ‡¥®‡¥ø‡¥≤‡¥®‡¥ø‡µº‡¥§‡µç‡¥§‡µÅ‡¥ï‡¥Ø‡µÅ‡¥Ç ‡¥®‡¥≤‡µç‡¥≤ ‡¥∂‡µÅ‡¥ö‡¥ø‡¥§‡µç‡¥µ‡¥Ç ‡¥™‡¥æ‡¥≤‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï‡¥Ø‡µÅ‡¥Ç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥ï."
      },
      hindi: {
        greeting: "‡§®‡§Æ‡§∏‡•ç‡§§‡•á! ‡§Æ‡•à‡§Ç ‡§°‡•â. AISH ‡§π‡•Ç‡§Ç, ‡§Ü‡§™‡§ï‡§æ AI ‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø ‡§∏‡§π‡§æ‡§Ø‡§ï‡•§",
        doTitle: "‡§Ü‡§™‡§ï‡•ã ‡§ï‡•ç‡§Ø‡§æ ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è",
        dontTitle: "‡§Ü‡§™‡§ï‡•ã ‡§ï‡•ç‡§Ø‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è",
        dos: [
          "‡§™‡•Ä‡§®‡•á ‡§∏‡•á ‡§™‡§π‡§≤‡•á ‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ 1 ‡§Æ‡§ø‡§®‡§ü ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡§æ‡§®‡•Ä ‡§â‡§¨‡§æ‡§≤‡•á‡§Ç",
          "‡§ñ‡§æ‡§®‡•á ‡§∏‡•á ‡§™‡§π‡§≤‡•á 20 ‡§∏‡•á‡§ï‡§Ç‡§° ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§æ‡§¨‡•Å‡§® ‡§∏‡•á ‡§π‡§æ‡§• ‡§ß‡•ã‡§è‡§Ç",
          "‡§™‡•Ä‡§®‡•á ‡§ï‡•á ‡§™‡§æ‡§®‡•Ä ‡§ï‡•ã ‡§∏‡§æ‡§´, ‡§¢‡§ï‡•á ‡§π‡•Å‡§è ‡§¨‡§∞‡•ç‡§§‡§®‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§∞‡§ñ‡•á‡§Ç",
          "‡§≤‡§ï‡•ç‡§∑‡§£ ‡§¶‡§ø‡§ñ‡§®‡•á ‡§ï‡•á 24 ‡§ò‡§Ç‡§ü‡•á ‡§ï‡•á ‡§≠‡•Ä‡§§‡§∞ ‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç",
          "‡§¶‡§∏‡•ç‡§§ ‡§π‡•ã‡§®‡•á ‡§™‡§∞ ORS ‡§ò‡•ã‡§≤ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç",
          "‡§ó‡§Ç‡§≠‡•Ä‡§∞ ‡§≤‡§ï‡•ç‡§∑‡§£‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§§‡•Å‡§∞‡§Ç‡§§ ‡§ö‡§ø‡§ï‡§ø‡§§‡•ç‡§∏‡§æ ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§≤‡•á‡§Ç"
        ],
        donts: [
          "‡§Ö‡§ú‡•ç‡§û‡§æ‡§§ ‡§∏‡•ç‡§∞‡•ã‡§§‡•ã‡§Ç ‡§∏‡•á ‡§¨‡§ø‡§®‡§æ ‡§â‡§™‡§ö‡§æ‡§∞‡§ø‡§§ ‡§™‡§æ‡§®‡•Ä ‡§® ‡§™‡§ø‡§è‡§Ç",
          "‡§∏‡§Ç‡§ï‡•ç‡§∞‡§Æ‡§ø‡§§ ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§¨‡§∞‡•ç‡§§‡§® ‡§∏‡§æ‡§ù‡§æ ‡§® ‡§ï‡§∞‡•á‡§Ç",
          "‡§ï‡§ö‡•ç‡§ö‡§æ ‡§Ø‡§æ ‡§Ö‡§ß‡§™‡§ï‡§æ ‡§≠‡•ã‡§ú‡§® ‡§® ‡§ñ‡§æ‡§è‡§Ç",
          "‡§≤‡§ó‡§æ‡§§‡§æ‡§∞ ‡§ó‡•à‡§∏‡•ç‡§ü‡•ç‡§∞‡•ã‡§á‡§Ç‡§ü‡•á‡§∏‡•ç‡§ü‡§æ‡§á‡§®‡§≤ ‡§≤‡§ï‡•ç‡§∑‡§£‡•ã‡§Ç ‡§ï‡•ã ‡§®‡§ú‡§∞‡§Ö‡§Ç‡§¶‡§æ‡§ú ‡§® ‡§ï‡§∞‡•á‡§Ç",
          "‡§â‡§≤‡•ç‡§ü‡•Ä ‡§Ø‡§æ ‡§¶‡§∏‡•ç‡§§ ‡§π‡•ã‡§®‡•á ‡§™‡§∞ ‡§≠‡•ã‡§ú‡§® ‡§® ‡§∏‡§Ç‡§≠‡§æ‡§≤‡•á‡§Ç",
          "‡§¶‡•Ç‡§∑‡§ø‡§§ ‡§ú‡§≤ ‡§®‡§ø‡§ï‡§æ‡§Ø‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§§‡•à‡§∞‡•á‡§Ç ‡§®‡§π‡•Ä‡§Ç"
        ],
        tip: "‡§Ø‡§æ‡§¶ ‡§∞‡§ñ‡•á‡§Ç: ‡§∞‡•ã‡§ï‡§•‡§æ‡§Æ ‡§á‡§≤‡§æ‡§ú ‡§∏‡•á ‡§¨‡•á‡§π‡§§‡§∞ ‡§π‡•à! ‡§π‡§æ‡§á‡§°‡•ç‡§∞‡•á‡§ü‡•á‡§° ‡§∞‡§π‡•á‡§Ç ‡§î‡§∞ ‡§Ö‡§ö‡•ç‡§õ‡•Ä ‡§∏‡•ç‡§µ‡§ö‡•ç‡§õ‡§§‡§æ ‡§¨‡§®‡§æ‡§è ‡§∞‡§ñ‡•á‡§Ç‡•§"
      },
      bengali: {
        greeting: "‡¶π‡ßç‡¶Ø‡¶æ‡¶≤‡ßã! ‡¶Ü‡¶Æ‡¶ø ‡¶°‡¶æ‡¶É AISH, ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ AI ‡¶∏‡ßç‡¶¨‡¶æ‡¶∏‡ßç‡¶•‡ßç‡¶Ø ‡¶∏‡¶π‡¶æ‡¶Ø‡¶º‡¶ï‡•§",
        doTitle: "‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ø‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶â‡¶ö‡¶ø‡¶§",
        dontTitle: "‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ø‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶â‡¶ö‡¶ø‡¶§ ‡¶®‡¶Ø‡¶º",
        dos: [
          "‡¶™‡¶æ‡¶® ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶Ü‡¶ó‡ßá ‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá ‡ßß ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü ‡¶™‡¶æ‡¶®‡¶ø ‡¶´‡ßã‡¶ü‡¶æ‡¶®",
          "‡¶ñ‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶Ü‡¶ó‡ßá ‡ß®‡ß¶ ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶∏‡¶æ‡¶¨‡¶æ‡¶® ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶π‡¶æ‡¶§ ‡¶ß‡ßÅ‡¶Ø‡¶º‡ßá ‡¶®‡¶ø‡¶®",
          "‡¶™‡¶æ‡¶®‡ßÄ‡¶Ø‡¶º ‡¶ú‡¶≤ ‡¶™‡¶∞‡¶ø‡¶∑‡ßç‡¶ï‡¶æ‡¶∞, ‡¶¢‡¶æ‡¶ï‡¶®‡¶æ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶™‡¶æ‡¶§‡ßç‡¶∞‡ßá ‡¶∞‡¶æ‡¶ñ‡ßÅ‡¶®",
          "‡¶≤‡¶ï‡ßç‡¶∑‡¶£ ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡ß®‡ß™ ‡¶ò‡¶®‡ßç‡¶ü‡¶æ‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®",
          "‡¶°‡¶æ‡¶Ø‡¶º‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ ‡¶π‡¶≤‡ßá ORS ‡¶¶‡ßç‡¶∞‡¶¨‡¶£ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®",
          "‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡¶∞ ‡¶≤‡¶ï‡ßç‡¶∑‡¶£‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶¨‡¶ø‡¶≤‡¶Æ‡ßç‡¶¨‡ßá ‡¶ö‡¶ø‡¶ï‡¶ø‡ßé‡¶∏‡¶æ ‡¶∏‡¶π‡¶æ‡¶Ø‡¶º‡¶§‡¶æ ‡¶®‡¶ø‡¶®"
        ],
        donts: [
          "‡¶Ö‡¶ú‡¶æ‡¶®‡¶æ ‡¶â‡ßé‡¶∏ ‡¶•‡ßá‡¶ï‡ßá ‡¶Ö‡¶™‡¶∞‡¶ø‡¶∂‡ßã‡¶ß‡¶ø‡¶§ ‡¶™‡¶æ‡¶®‡¶ø ‡¶™‡¶æ‡¶® ‡¶ï‡¶∞‡¶¨‡ßá‡¶® ‡¶®‡¶æ",
          "‡¶∏‡¶Ç‡¶ï‡ßç‡¶∞‡¶Æ‡¶ø‡¶§ ‡¶¨‡ßç‡¶Ø‡¶ï‡ßç‡¶§‡¶ø‡¶¶‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶™‡¶æ‡¶§‡ßç‡¶∞ ‡¶≠‡¶æ‡¶ó ‡¶ï‡¶∞‡¶¨‡ßá‡¶® ‡¶®‡¶æ",
          "‡¶ï‡¶æ‡¶Å‡¶ö‡¶æ ‡¶¨‡¶æ ‡¶Ü‡¶ß‡¶æ ‡¶∞‡¶æ‡¶®‡ßç‡¶®‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞ ‡¶ñ‡¶æ‡¶¨‡ßá‡¶® ‡¶®‡¶æ",
          "‡¶ï‡ßç‡¶∞‡¶Æ‡¶æ‡¶ó‡¶§ ‡¶™‡¶æ‡¶ö‡¶®‡¶§‡¶®‡ßç‡¶§‡ßç‡¶∞‡ßá‡¶∞ ‡¶≤‡¶ï‡ßç‡¶∑‡¶£ ‡¶â‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶¨‡ßá‡¶® ‡¶®‡¶æ",
          "‡¶¨‡¶Æ‡¶ø ‡¶¨‡¶æ ‡¶°‡¶æ‡¶Ø‡¶º‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ ‡¶π‡¶≤‡ßá ‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶®‡¶æ ‡¶ï‡¶∞‡¶¨‡ßá‡¶® ‡¶®‡¶æ",
          "‡¶¶‡ßÇ‡¶∑‡¶ø‡¶§ ‡¶ú‡¶≤‡¶æ‡¶∂‡¶Ø‡¶º‡ßá ‡¶∏‡¶æ‡¶Å‡¶§‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶ü‡¶¨‡ßá‡¶® ‡¶®‡¶æ"
        ],
        tip: "‡¶Æ‡¶®‡ßá ‡¶∞‡¶æ‡¶ñ‡¶¨‡ßá‡¶®: ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ï‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ö‡ßá‡¶Ø‡¶º‡ßá ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∞‡ßã‡¶ß ‡¶≠‡¶æ‡¶≤! ‡¶π‡¶æ‡¶á‡¶°‡ßç‡¶∞‡ßá‡¶ü‡ßá‡¶° ‡¶•‡¶æ‡¶ï‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶≠‡¶æ‡¶≤ ‡¶∏‡ßç‡¶¨‡¶æ‡¶∏‡ßç‡¶•‡ßç‡¶Ø‡¶¨‡¶ø‡¶ß‡¶ø ‡¶¨‡¶ú‡¶æ‡¶Ø‡¶º ‡¶∞‡¶æ‡¶ñ‡ßÅ‡¶®‡•§"
      }
    };

    function changeLanguage(lang) {
      currentLanguage = lang;
      saveToStorage('preferredLanguage', lang);
      
      document.querySelectorAll('.language-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      event.target.classList.add('active');
      
      updateProtocolsDisplay();
      showNotification(`Language changed to ${lang}`, 'success');
    }

    function updateProtocolsDisplay() {
      const content = translations[currentLanguage];
      const protocolsContainer = document.getElementById('protocolsContent');
      
      if (protocolsContainer) {
        protocolsContainer.innerHTML = `
          <div style="display: flex; align-items: center; justify-content: center; gap: 32px; margin-bottom: 40px; padding: 32px; background: linear-gradient(135deg, #e3f2fd 0%, #e8f5e9 100%); border-radius: 16px; position: relative; overflow: hidden;">
            <div class="ai-doctor-avatar">
              ü§ñ
            </div>
            
            <div style="flex: 1; max-width: 600px;">
              <div class="ai-badge" style="margin-bottom: 16px;">
                AI-Powered Health Assistant
              </div>
              <div style="font-family: 'Poppins', sans-serif; font-size: 20px; color: #2c3e50; font-weight: 700; margin-bottom: 12px;">
                ${content.greeting}
              </div>
              <div style="font-size: 14px; color: #546e7a; display: flex; align-items: center;">
                <span>Analyzing health protocols</span>
                <span class="ai-thinking">
                  <span></span>
                  <span></span>
                  <span></span>
                </span>
              </div>
            </div>
          </div>

          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-bottom: 32px;">
            <div class="protocol-card do-card">
              <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 20px;">
                <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #27ae60 0%, #229954 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; box-shadow: 0 4px 12px rgba(39, 174, 96, 0.3); color: white;">
                  ‚úì
                </div>
                <div>
                  <div style="color: #27ae60; font-size: 16px; font-family: 'Poppins', sans-serif; font-weight: 700;">${content.doTitle}</div>
                  <div style="font-size: 11px; color: #95a5a6; text-transform: uppercase; letter-spacing: 1px;">Recommended Actions</div>
                </div>
              </div>
              <ul style="margin-top: 16px; list-style: none; padding: 0;">
                ${content.dos.map((item, i) => `
                  <li style="margin-bottom: 14px; padding-left: 24px; position: relative; animation: slideIn 0.5s ease-out ${i * 0.1}s both; color: #546e7a;">
                    <span style="position: absolute; left: 0; color: #27ae60;">‚ñ∏</span>
                    ${item}
                  </li>
                `).join('')}
              </ul>
            </div>
            
            <div class="protocol-card dont-card">
              <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 20px;">
                <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; box-shadow: 0 4px 12px rgba(231, 76, 60, 0.3); color: white;">
                  ‚úó
                </div>
                <div>
                  <div style="color: #e74c3c; font-size: 16px; font-family: 'Poppins', sans-serif; font-weight: 700;">${content.dontTitle}</div>
                  <div style="font-size: 11px; color: #95a5a6; text-transform: uppercase; letter-spacing: 1px;">Actions to Avoid</div>
                </div>
              </div>
              <ul style="margin-top: 16px; list-style: none; padding: 0;">
                ${content.donts.map((item, i) => `
                  <li style="margin-bottom: 14px; padding-left: 24px; position: relative; animation: slideIn 0.5s ease-out ${i * 0.1}s both; color: #546e7a;">
                    <span style="position: absolute; left: 0; color: #e74c3c;">‚ñ∏</span>
                    ${item}
                  </li>
                `).join('')}
              </ul>
            </div>
          </div>

          <div style="padding: 28px; background: linear-gradient(135deg, #e3f2fd 0%, #e8f5e9 100%); border-radius: 12px; border: 2px solid #90caf9; text-align: center; position: relative; overflow: hidden; box-shadow: 0 4px 16px rgba(52, 152, 219, 0.2);">
            <div style="font-size: 48px; margin-bottom: 16px; animation: pulse 2s ease-in-out infinite;">üí°</div>
            <div style="font-family: 'Poppins', sans-serif; font-size: 12px; color: #7f8c8d; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 8px;">AI Tip of the Day</div>
            <div style="font-size: 16px; color: #2c3e50; font-weight: 600; line-height: 1.6;">
              ${content.tip}
            </div>
          </div>
        `;
      }
    }

    // MongoDB API Configuration
    // ‚¨áÔ∏è After deploying to Render, replace this URL with your Render backend URL
    // Example: 'https://aish-health-backend.onrender.com/api'
    // For local development, use: 'http://localhost:3000/api'
    const API_URL = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'
      ? 'http://localhost:3000/api'
      : 'https://aish-health-1.onrender.com/api';
    let serverAvailable = false;
    
    // Check server availability
    async function checkServerConnection() {
      try {
        const response = await fetch(`${API_URL}/health`, {
          method: 'GET',
          headers: { 'Content-Type': 'application/json' }
        });
        
        if (response.ok) {
          serverAvailable = true;
          console.log('‚úì Connected to backend server');
          return true;
        }
      } catch (error) {
        serverAvailable = false;
        console.warn('‚ö† Backend server not available, using offline mode');
      }
      return false;
    }
    
    // MongoDB API Functions
    async function saveToStorage(key, data) {
      try {
        // Still use localStorage as backup for non-case data
        if (key !== 'healthCases') {
          localStorage.setItem(key, JSON.stringify(data));
          return;
        }
        
        // For cases, save to MongoDB
        // This is handled by individual case operations now
        localStorage.setItem(key, JSON.stringify(data)); // Backup
      } catch (e) {
        console.error('Storage error:', e);
      }
    }

    function loadFromStorage(key) {
      try {
        const data = localStorage.getItem(key);
        return data ? JSON.parse(data) : null;
      } catch (e) {
        console.error('Storage error:', e);
        return null;
      }
    }

    // MongoDB API Functions
    async function fetchAllCases() {
      // Check if server is available first
      if (!serverAvailable && !await checkServerConnection()) {
        console.log('Using localStorage (offline mode)');
        cases = loadFromStorage('healthCases') || [];
        updateDashboard();
        renderCaseTable();
        updateMapMarkers(); updateAnalytics();
        return cases;
      }
      
      try {
        const response = await fetch(`${API_URL}/cases`, { cache: 'no-store' });
        if (!response.ok) throw new Error('Failed to fetch cases');
        const data = await response.json();
        cases = data.map(c => ({
          ...c,
          _id: c._id,
          synced: true
        }));
        saveToStorage('healthCases', cases); // keep offline backup in sync
        serverAvailable = true;
        updateDashboard();
        renderCaseTable();
        updateMapMarkers(); updateAnalytics();
        return cases;
      } catch (error) {
        console.error('Error fetching cases:', error);
        serverAvailable = false;
        // Fallback to localStorage
        cases = loadFromStorage('healthCases') || [];
        updateDashboard();
        renderCaseTable();
        updateMapMarkers(); updateAnalytics();
        return cases;
      }
    }

    async function createCase(caseData) {
      try {
        const response = await fetch(`${API_URL}/cases`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(caseData)
        });
        
        if (!response.ok) throw new Error('Failed to create case');
        
        const savedCase = await response.json();
        return savedCase;
      } catch (error) {
        console.error('Error creating case:', error);
        // Add to sync queue for later
        syncQueue.push(caseData);
        saveToStorage('syncQueue', syncQueue);
        throw error;
      }
    }

    async function updateCase(caseId, caseData) {
      try {
        const response = await fetch(`${API_URL}/cases/${caseId}`, {
          method: 'PUT',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(caseData)
        });
        
        if (!response.ok) throw new Error('Failed to update case');
        
        const updatedCase = await response.json();
        return updatedCase;
      } catch (error) {
        console.error('Error updating case:', error);
        throw error;
      }
    }

    async function deleteCase(caseId) {
      try {
        const response = await fetch(`${API_URL}/cases/${caseId}`, {
          method: 'DELETE'
        });
        
        if (!response.ok) throw new Error('Failed to delete case');
        
        const result = await response.json();
        return result;
      } catch (error) {
        console.error('Error deleting case:', error);
        throw error;
      }
    }

    async function syncQueuedCasesToMongoDB() {
      if (syncQueue.length === 0) return;
      
      try {
        const response = await fetch(`${API_URL}/cases/sync`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ cases: syncQueue })
        });
        
        if (!response.ok) throw new Error('Failed to sync cases');
        
        const result = await response.json();
        syncQueue = [];
        saveToStorage('syncQueue', []);
        showNotification(`‚úì ${result.cases.length} cases synced to database`, 'success');
        
        // Refresh cases from database
        await fetchAllCases();
      } catch (error) {
        console.error('Error syncing queued cases:', error);
        showNotification('‚ö† Sync failed, will retry later', 'warning');
      }
    }

    function showNotification(message, type = 'success') {
      const notification = document.createElement('div');
      notification.className = `notification ${type}`;
      notification.textContent = message;
      document.body.appendChild(notification);
      setTimeout(() => notification.remove(), 3000);
    }

    function updateDashboard() {
      const total = cases.length;
      const active = cases.filter(c => c.status === 'Active').length;
      const critical = cases.filter(c => c.severity === 'high').length;
      const recovered = cases.filter(c => c.status === 'Recovered').length;

      document.getElementById('totalCases').textContent = total;
      document.getElementById('activeCases').textContent = active;
      document.getElementById('criticalCases').textContent = critical;
      document.getElementById('recoveredCases').textContent = recovered;
    }

    function renderCaseTable() {
      const tbody = document.getElementById('caseTableBody');
      // Wipe ALL rows ‚Äî DB is the single source of truth
      tbody.innerHTML = '';

      const severityMap = { high: 'severity-high', medium: 'severity-medium', low: 'severity-low' };
      const severityText = { high: 'Critical', medium: 'Medium', low: 'Low' };
      const isAdmin = currentUser && currentUser.role === 'admin';

      if (cases.length === 0) {
        const emptyRow = tbody.insertRow();
        emptyRow.innerHTML = `<td colspan="7" style="text-align:center; color:#95a5a6; padding:32px; font-family:'Poppins',sans-serif;">No cases reported yet.</td>`;
        return;
      }

      cases.forEach((caseData, index) => {
        const row = tbody.insertRow(0);
        row.innerHTML = `
          <td><strong>${caseData.name}</strong><br><span style="color: #95a5a6;">Age: ${caseData.age}</span></td>
          <td>${caseData.location}</td>
          <td>${caseData.symptoms.split(', ').map(s => `<span class="symptom-badge">${s}</span>`).join('')}</td>
          <td><span class="severity-badge ${severityMap[caseData.severity]}">${severityText[caseData.severity]}</span></td>
          <td><span style="color: ${caseData.status === 'Active' ? '#e74c3c' : '#27ae60'}; font-weight: 700;">${caseData.status}</span></td>
          <td>${caseData.date}</td>
          <td>${isAdmin ? `
            <button class="jarvis-btn jarvis-btn-primary" onclick="editCaseModal(${index})" style="margin-right: 8px;">‚úèÔ∏è Edit</button>
            <button class="jarvis-btn jarvis-btn-danger" onclick="deleteCase(${index})">üóëÔ∏è Delete</button>
          ` : ''}</td>
        `;
      });
    }

    async function deleteCaseFunc(index) {
      if (!currentUser || currentUser.role !== 'admin') {
        showNotification('‚ö†Ô∏è Admin access required', 'error');
        return;
      }

      const caseToDelete = cases[index];
      const confirmMessage = `‚ö†Ô∏è DELETE CASE CONFIRMATION\n\n` +
        `This action CANNOT be undone!\n\n` +
        `Patient: ${caseToDelete.name}\n` +
        `Age: ${caseToDelete.age}\n` +
        `Location: ${caseToDelete.location}\n` +
        `Severity: ${caseToDelete.severity}\n` +
        `Date: ${caseToDelete.date}\n\n` +
        `Are you absolutely sure you want to DELETE this case?`;

      if (confirm(confirmMessage)) {
        if (caseToDelete._id && isOnline) {
          try {
            await deleteCase(caseToDelete._id);
            cases.splice(index, 1);
            showNotification(`‚úì Case deleted from database: ${caseToDelete.name}`, 'success');
          } catch (error) {
            showNotification('‚ùå Failed to delete case from database', 'error');
            return;
          }
        } else {
          cases.splice(index, 1);
          saveToStorage('healthCases', cases);
          showNotification(`‚úì Case deleted locally: ${caseToDelete.name}`, 'success');
        }
        
        renderCaseTable();
        updateDashboard();
        updateMapMarkers(); updateAnalytics();
      }
    }
    window.deleteCase = deleteCaseFunc;

    // Edit Case Functions
    let currentEditIndex = null;

    function editCaseModal(index) {
      if (!currentUser || currentUser.role !== 'admin') {
        showNotification('‚ö†Ô∏è Admin access required', 'error');
        return;
      }

      currentEditIndex = index;
      const caseData = cases[index];

      // Populate form
      document.getElementById('editPatientName').value = caseData.name;
      document.getElementById('editPatientAge').value = caseData.age;
      document.getElementById('editPatientLocation').value = caseData.location;
      document.getElementById('editPatientSymptoms').value = caseData.symptoms;
      document.getElementById('editWaterSource').value = caseData.waterSource;
      document.getElementById('editSeverity').value = caseData.severity;
      document.getElementById('editStatus').value = caseData.status;

      // Show modal
      document.getElementById('editCaseModal').classList.add('active');
    }
    window.editCaseModal = editCaseModal;

    function closeEditModal() {
      document.getElementById('editCaseModal').classList.remove('active');
      currentEditIndex = null;
    }
    window.closeEditModal = closeEditModal;

    // Edit case form submission
    document.getElementById('editCaseForm').addEventListener('submit', async (e) => {
      e.preventDefault();

      if (currentEditIndex === null) return;

      const updatedCase = {
        ...cases[currentEditIndex],
        name: document.getElementById('editPatientName').value,
        age: parseInt(document.getElementById('editPatientAge').value),
        location: document.getElementById('editPatientLocation').value,
        symptoms: document.getElementById('editPatientSymptoms').value,
        waterSource: document.getElementById('editWaterSource').value,
        severity: document.getElementById('editSeverity').value,
        status: document.getElementById('editStatus').value
      };

      // Try to update in MongoDB
      if (updatedCase._id && serverAvailable && isOnline) {
        try {
          await updateCase(updatedCase._id, updatedCase);
          showNotification('‚úì Case updated in database', 'success');
          closeEditModal();
          await fetchAllCases(); // re-fetch so all users see fresh state
        } catch (error) {
          console.error('Error updating case:', error);
          cases[currentEditIndex] = updatedCase;
          saveToStorage('healthCases', cases);
          showNotification('‚ö† Update saved locally, will sync later', 'warning');
        }
      } else {
        cases[currentEditIndex] = updatedCase;
        saveToStorage('healthCases', cases);
        showNotification('‚ö† Update saved locally', 'warning');
      }

      updateDashboard();
      renderCaseTable();
      updateMapMarkers(); updateAnalytics();
      closeEditModal();
    });

    // Close modal when clicking outside
    document.getElementById('editCaseModal').addEventListener('click', (e) => {
      if (e.target.id === 'editCaseModal') {
        closeEditModal();
      }
    });

    // Show/hide report form based on role
    function updateReportTabVisibility() {
      const isObserver = !currentUser || currentUser.role === 'viewer';
      document.getElementById('reportFormContainer').style.display = isObserver ? 'none' : 'block';
      document.getElementById('reportBlockedMessage').style.display = isObserver ? 'block' : 'none';
    }

    function loginUser() {
      document.getElementById('loginModal').classList.remove('active');
      document.getElementById('userBadge').style.display = 'flex';
      document.getElementById('userIcon').textContent = currentUser.icon;
      document.getElementById('userName').textContent = currentUser.name;
      if (currentUser.role === 'admin') {
        document.getElementById('adminBtn').style.display = 'block';
        document.getElementById('actionsHeader').style.display = 'table-cell';
      }
      saveToStorage('currentUser', currentUser);
      updateReportTabVisibility();
      renderCaseTable();
      showNotification(`‚úì Welcome ${currentUser.name}`, 'success');
    }

    function initMap() {
      if (map) return;
      const mapContainer = document.getElementById('map');
      if (!isOnline) {
        mapContainer.innerHTML = `<div style="display:flex;align-items:center;justify-content:center;height:100%;background:#f8f9fa;border-radius:8px;"><div style="text-align:center;color:#95a5a6;"><div style="font-size:48px;margin-bottom:16px;">‚ö†</div><div style="font-family:'Poppins',sans-serif;font-size:14px;font-weight:600;">Map Unavailable</div><div style="font-size:12px;margin-top:8px;">Internet connection required</div></div></div>`;
        return;
      }
      try {
        map = L.map('map').setView([20.5937, 78.9629], 5); // Centre on India
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { attribution: '¬© OpenStreetMap' }).addTo(map);
        updateMapMarkers(); updateAnalytics();
      } catch (e) { console.error('Map error:', e); }
    }

    // ‚îÄ‚îÄ‚îÄ Dynamic map: zones sized by real case counts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    let zoneCircles = [];
    function updateMapMarkers() {
      if (!map) return;

      // Remove old user markers
      userMarkers.forEach(m => map.removeLayer(m));
      userMarkers = [];

      // Remove old zone circles
      zoneCircles.forEach(c => map.removeLayer(c));
      zoneCircles = [];

      // Group cases by location name
      const locationGroups = {};
      cases.forEach(c => {
        const key = c.location ? c.location.trim().toLowerCase() : null;
        if (!key) return;
        if (!locationGroups[key]) locationGroups[key] = { name: c.location, count: 0, lat: c.lat, lng: c.lng, critical: 0 };
        locationGroups[key].count++;
        if (c.severity === 'high') locationGroups[key].critical++;
        // Use first available coords for this location
        if (!locationGroups[key].lat && c.lat) { locationGroups[key].lat = c.lat; locationGroups[key].lng = c.lng; }
      });

      // Draw a zone circle for each location that has coords
      Object.values(locationGroups).forEach(loc => {
        if (!loc.lat || !loc.lng) return;
        const color = loc.count >= 10 ? '#e74c3c' : loc.count >= 5 ? '#f57c00' : loc.count >= 2 ? '#3498db' : '#27ae60';
        const circle = L.circle([loc.lat, loc.lng], {
          color, fillColor: color, fillOpacity: 0.25,
          radius: loc.count * 8000 + 15000
        }).addTo(map);
        circle.bindPopup(`<strong>${loc.name}</strong><br>Total cases: ${loc.count}<br>Critical: ${loc.critical}`);
        zoneCircles.push(circle);
      });

      // Individual case pin markers
      cases.forEach(c => {
        if (!c.lat || !c.lng) return;
        const color = c.severity === 'high' ? '#e74c3c' : c.severity === 'medium' ? '#f57c00' : '#27ae60';
        const marker = L.marker([c.lat, c.lng], {
          icon: L.divIcon({
            className: 'custom-marker',
            html: `<div style="background:${color};border-radius:50%;width:14px;height:14px;border:2px solid white;box-shadow:0 2px 6px rgba(0,0,0,0.35);"></div>`,
            iconSize: [14, 14]
          })
        }).addTo(map);
        marker.bindPopup(`<strong>${c.name}</strong><br>üìç ${c.location}<br>ü©∫ ${c.symptoms}<br>‚ö† ${c.severity}<br>üìÖ ${c.date}<br>üë§ ${c.reportedBy || 'Unknown'}`);
        userMarkers.push(marker);
      });
    }

    // ‚îÄ‚îÄ‚îÄ Dynamic chart: real dates + real counts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function buildChartData() {
      // Get last 7 days
      const days = [];
      const counts = [];
      for (let i = 6; i >= 0; i--) {
        const d = new Date();
        d.setDate(d.getDate() - i);
        const label = d.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
        days.push(label);
        const dayCount = cases.filter(c => c.date === label).length;
        counts.push(dayCount);
      }
      // Simple linear forecast: average daily growth * 7 days
      const recentAvg = counts.slice(-3).reduce((a, b) => a + b, 0) / 3;
      const forecast = [];
      counts.forEach((v, i) => forecast.push(i < 5 ? null : v)); // overlap last 2 days
      for (let i = 1; i <= 5; i++) forecast.push(Math.round(recentAvg * (1 + i * 0.15)));
      const forecastLabels = [...days];
      for (let i = 1; i <= 5; i++) {
        const d = new Date();
        d.setDate(d.getDate() + i);
        forecastLabels.push(d.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }));
      }
      return { labels: forecastLabels, actual: [...counts, null, null, null, null, null], forecast };
    }

    function initChart() {
      const ctx = document.getElementById('trendChart');
      if (!ctx) return;
      const { labels, actual, forecast } = buildChartData();
      if (chart) { chart.destroy(); chart = null; }
      chart = new Chart(ctx, {
        type: 'line',
        data: {
          labels,
          datasets: [{
            label: 'Actual Cases',
            data: actual,
            borderColor: '#3498db', backgroundColor: 'rgba(52,152,219,0.1)',
            tension: 0.4, fill: true, borderWidth: 3,
            pointRadius: 6, pointHoverRadius: 8,
            pointBackgroundColor: '#3498db', pointBorderColor: '#ffffff', pointBorderWidth: 2
          }, {
            label: 'AI Prediction',
            data: forecast,
            borderColor: '#f57c00', backgroundColor: 'rgba(245,124,0,0.08)',
            tension: 0.4, fill: true, borderWidth: 3,
            borderDash: [10, 5],
            pointRadius: 5, pointHoverRadius: 7,
            pointBackgroundColor: '#f57c00', pointBorderColor: '#ffffff', pointBorderWidth: 2
          }]
        },
        options: {
          responsive: true, maintainAspectRatio: false,
          interaction: { mode: 'index', intersect: false },
          plugins: { legend: { labels: { font: { family: 'Inter', size: 13, weight: '600' } } } },
          scales: { y: { beginAtZero: true, ticks: { stepSize: 1 } } }
        }
      });
    }

    // ‚îÄ‚îÄ‚îÄ Master analytics updater ‚Äî called every time cases change ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function updateAnalytics() {
      if (cases.length === 0) {
        document.getElementById('riskLevel').textContent = 'LOW';
        document.getElementById('riskDesc').textContent = 'No cases reported yet.';
        document.getElementById('forecastNum').textContent = '+0';
        document.getElementById('forecastDesc').textContent = 'No data to forecast from yet.';
        document.getElementById('topRiskFactor').textContent = 'N/A';
        document.getElementById('topRiskDesc').textContent = 'No cases reported yet.';
        document.getElementById('heatGrid').innerHTML = `<div style="text-align:center;color:#95a5a6;padding:32px;grid-column:1/-1;">No cases in database yet.</div>`;
        document.getElementById('aiRecommendation').textContent = 'No cases reported yet. System is monitoring.';
        document.getElementById('aiAnalysisText').textContent = 'No data available yet. Cases will appear here once reported.';
        return;
      }

      // ‚îÄ‚îÄ Risk Level ‚îÄ‚îÄ
      const critical = cases.filter(c => c.severity === 'high').length;
      const active = cases.filter(c => c.status === 'Active').length;
      const total = cases.length;
      let riskLevel, riskColor, riskBg;
      if (critical >= 5 || active / total > 0.6) { riskLevel = 'HIGH'; riskColor = '#e74c3c'; riskBg = 'linear-gradient(135deg,#ffebee 0%,#ffffff 100%)'; }
      else if (critical >= 2 || active / total > 0.3) { riskLevel = 'MEDIUM'; riskColor = '#f57c00'; riskBg = 'linear-gradient(135deg,#fff3e0 0%,#ffffff 100%)'; }
      else { riskLevel = 'LOW'; riskColor = '#27ae60'; riskBg = 'linear-gradient(135deg,#e8f5e9 0%,#ffffff 100%)'; }
      document.getElementById('riskLevel').textContent = riskLevel;
      document.getElementById('riskLevel').style.color = riskColor;
      document.getElementById('riskCard').style.background = riskBg;
      document.getElementById('riskDesc').textContent = `${critical} critical case${critical !== 1 ? 's' : ''}, ${active} active out of ${total} total. ${riskLevel === 'HIGH' ? 'Immediate action recommended.' : riskLevel === 'MEDIUM' ? 'Monitor closely.' : 'Situation under control.'}`;

      // ‚îÄ‚îÄ Forecast ‚îÄ‚îÄ
      const last7 = cases.filter(c => {
        try { const d = new Date(c.timestamp); return (Date.now() - d) < 7 * 86400000; } catch { return false; }
      }).length;
      const forecast = Math.round(last7 * 1.2);
      document.getElementById('forecastNum').textContent = `+${forecast}`;
      document.getElementById('forecastDesc').textContent = `Based on ${last7} cases in the last 7 days. Projected trend for next week.`;

      // ‚îÄ‚îÄ Top Risk Factor (water source) ‚îÄ‚îÄ
      const sourceCounts = {};
      cases.forEach(c => { if (c.waterSource) sourceCounts[c.waterSource] = (sourceCounts[c.waterSource] || 0) + 1; });
      const topSource = Object.entries(sourceCounts).sort((a, b) => b[1] - a[1])[0];
      if (topSource) {
        const pct = Math.round((topSource[1] / total) * 100);
        document.getElementById('topRiskFactor').textContent = topSource[0].toUpperCase();
        document.getElementById('topRiskDesc').textContent = `${pct}% of cases (${topSource[1]}) linked to ${topSource[0]}. Focus containment here.`;
      }

      // ‚îÄ‚îÄ Geographic Heat Cards ‚îÄ‚îÄ
      const locationGroups = {};
      cases.forEach(c => {
        const key = c.location ? c.location.trim() : 'Unknown';
        if (!locationGroups[key]) locationGroups[key] = { count: 0, critical: 0 };
        locationGroups[key].count++;
        if (c.severity === 'high') locationGroups[key].critical++;
      });
      const sorted = Object.entries(locationGroups).sort((a, b) => b[1].count - a[1].count);
      const heatGrid = document.getElementById('heatGrid');
      heatGrid.innerHTML = sorted.map(([loc, data]) => {
        const color = data.count >= 10 ? '#e74c3c' : data.count >= 5 ? '#f57c00' : data.count >= 2 ? '#3498db' : '#27ae60';
        const label = data.count >= 10 ? 'Critical Zone' : data.count >= 5 ? 'Elevated' : data.count >= 2 ? 'Moderate' : 'Low Risk';
        return `<div class="protocol-card">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
            <div style="font-family:'Poppins',sans-serif;font-size:14px;color:#2c3e50;font-weight:600;">${loc}</div>
            <div style="width:12px;height:12px;background:${color};border-radius:50%;box-shadow:0 0 10px ${color};animation:pulse 1s infinite;"></div>
          </div>
          <div style="font-family:'Poppins',sans-serif;font-size:28px;color:${color};font-weight:700;margin-bottom:8px;">${data.count}</div>
          <div style="font-size:12px;color:#7f8c8d;">${label} ‚Ä¢ ${data.critical} critical</div>
        </div>`;
      }).join('');

      // ‚îÄ‚îÄ AI Recommendation ‚îÄ‚îÄ
      const topLoc = sorted[0];
      let rec = '';
      if (topLoc) {
        const [name, data] = topLoc;
        if (data.count >= 10) rec += `üö® Deploy emergency response to ${name} immediately. `;
        else if (data.count >= 5) rec += `‚ö†Ô∏è Increase surveillance in ${name}. `;
        else rec += `‚úÖ Monitor ${name} closely. `;
      }
      if (topSource) rec += `Focus water testing on ${topSource[0]} sources. `;
      if (riskLevel === 'HIGH') rec += 'Activate outbreak response protocol.';
      else if (riskLevel === 'MEDIUM') rec += 'Continue preventive measures and public health advisories.';
      else rec += 'Maintain current monitoring protocols.';
      document.getElementById('aiRecommendation').textContent = rec;

      // ‚îÄ‚îÄ AI Analysis Text ‚îÄ‚îÄ
      const recentCount = cases.filter(c => { try { return (Date.now() - new Date(c.timestamp)) < 3 * 86400000; } catch { return false; } }).length;
      document.getElementById('aiAnalysisText').textContent = `${recentCount} case${recentCount !== 1 ? 's' : ''} reported in the last 3 days. Risk level is ${riskLevel.toLowerCase()}. ${topSource ? `${topSource[0]} is the dominant contamination source at ${Math.round(topSource[1]/total*100)}%.` : ''} ${riskLevel === 'HIGH' ? 'Recommend immediate water quality testing in all affected zones.' : 'Continue monitoring and preventive public health measures.'}`;

      // Refresh chart with real data
      initChart();
    }

    function switchTab(tabName) {
      document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
      document.querySelectorAll('main > div').forEach(section => {
        if (section.id === tabName) {
          section.classList.remove('section-hidden');
          section.classList.add('section-visible');
          document.querySelector(`[data-tab="${tabName}"]`)?.classList.add('active');
        } else {
          section.classList.remove('section-visible');
          section.classList.add('section-hidden');
        }
      });

      if (tabName === 'water') setTimeout(() => { initMap(); updateMapMarkers(); }, 100);
      if (tabName === 'analytics') setTimeout(() => updateAnalytics(), 100);
      if (tabName === 'protocols') updateProtocolsDisplay();
      if (tabName === 'report') updateReportTabVisibility();
    }

    // Character selection
    document.querySelectorAll('.character-card').forEach(card => {
      card.addEventListener('click', () => {
        const role = card.getAttribute('data-role');
        if (role === 'admin') {
          document.getElementById('characterSelect').style.display = 'none';
          document.getElementById('adminLoginForm').style.display = 'block';
        } else if (role === 'doctor') {
          document.getElementById('characterSelect').style.display = 'none';
          document.getElementById('doctorLoginForm').style.display = 'block';
          loadDoctorsFromDB();
        } else if (role === 'viewer') {
          currentUser = { role: 'viewer', name: 'Observer', icon: 'üëÅ' };
          loginUser();
        }
      });
    });

    // Back buttons
    document.getElementById('backBtnDoctor').addEventListener('click', () => {
      document.getElementById('characterSelect').style.display = 'grid';
      document.getElementById('doctorLoginForm').style.display = 'none';
      document.getElementById('doctorError').style.display = 'none';
      document.getElementById('registerError').style.display = 'none';
      document.getElementById('registerSuccess').style.display = 'none';
    });

    document.getElementById('backBtnAdmin').addEventListener('click', () => {
      document.getElementById('characterSelect').style.display = 'grid';
      document.getElementById('adminLoginForm').style.display = 'none';
      document.getElementById('adminError').style.display = 'none';
    });

    // =============================================
    // TAB SWITCHER ‚Äî Login / Register
    // =============================================
    function showDoctorTab(tab) {
      if (tab === 'login') {
        document.getElementById('doctorLoginTab').style.display = 'block';
        document.getElementById('doctorRegisterTab').style.display = 'none';
        document.getElementById('showLoginTab').style.background = '#3498db';
        document.getElementById('showLoginTab').style.color = 'white';
        document.getElementById('showRegisterTab').style.background = '#e9ecef';
        document.getElementById('showRegisterTab').style.color = '#546e7a';
        loadDoctorsFromDB();
      } else {
        document.getElementById('doctorLoginTab').style.display = 'none';
        document.getElementById('doctorRegisterTab').style.display = 'block';
        document.getElementById('showRegisterTab').style.background = '#27ae60';
        document.getElementById('showRegisterTab').style.color = 'white';
        document.getElementById('showLoginTab').style.background = '#e9ecef';
        document.getElementById('showLoginTab').style.color = '#546e7a';
      }
    }
    window.showDoctorTab = showDoctorTab;

    // Load doctor names from MongoDB into dropdown
    async function loadDoctorsFromDB() {
      try {
        const res = await fetch(`${API_URL}/auth/doctors`, { cache: 'no-store' });
        if (!res.ok) throw new Error('Failed');
        const doctors = await res.json();
        const select = document.getElementById('doctorSelect');
        select.innerHTML = '<option value="">-- Select your name --</option>';
        doctors.forEach(doc => {
          const option = document.createElement('option');
          option.value = doc.name;
          option.textContent = doc.name;
          select.appendChild(option);
        });
      } catch (err) {
        console.warn('Could not load doctors from DB ‚Äî server may be waking up');
      }
    }

    // =============================================
    // DOCTOR LOGIN ‚Äî calls /api/auth/login
    // =============================================
    document.getElementById('doctorLoginBtn').addEventListener('click', async () => {
      const name = document.getElementById('doctorSelect').value;
      const password = document.getElementById('doctorPassword').value;
      const errorEl = document.getElementById('doctorError');
      errorEl.style.display = 'none';

      if (!name) { showNotification('‚ùå Please select your name', 'error'); return; }
      if (!password) { showNotification('‚ùå Please enter your password', 'error'); return; }

      try {
        const res = await fetch(`${API_URL}/auth/login`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ name, password })
        });
        const data = await res.json();
        if (!res.ok) {
          errorEl.textContent = '‚ùå ' + data.error;
          errorEl.style.display = 'block';
          return;
        }
        currentUser = { role: 'doctor', name: data.name, icon: '‚öï' };
        document.getElementById('doctorPassword').value = '';
        loginUser();
      } catch (err) {
        errorEl.textContent = '‚ùå Could not reach server. Please try again.';
        errorEl.style.display = 'block';
      }
    });

    // =============================================
    // DOCTOR REGISTER ‚Äî calls /api/auth/register
    // =============================================
    document.getElementById('doctorRegisterBtn').addEventListener('click', async () => {
      const name = document.getElementById('registerName').value.trim();
      const password = document.getElementById('registerPassword').value;
      const confirm = document.getElementById('registerConfirm').value;
      const errorEl = document.getElementById('registerError');
      const successEl = document.getElementById('registerSuccess');
      errorEl.style.display = 'none';
      successEl.style.display = 'none';

      if (!name) { errorEl.textContent = '‚ùå Please enter your name.'; errorEl.style.display = 'block'; return; }
      if (password.length < 6) { errorEl.textContent = '‚ùå Password must be at least 6 characters.'; errorEl.style.display = 'block'; return; }
      if (password !== confirm) { errorEl.textContent = '‚ùå Passwords do not match.'; errorEl.style.display = 'block'; return; }

      try {
        const res = await fetch(`${API_URL}/auth/register`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ name, password })
        });
        const data = await res.json();
        if (!res.ok) {
          errorEl.textContent = '‚ùå ' + data.error;
          errorEl.style.display = 'block';
          return;
        }
        successEl.textContent = `‚úì Account created for ${data.name}! Switch to Login tab to sign in.`;
        successEl.style.display = 'block';
        document.getElementById('registerName').value = '';
        document.getElementById('registerPassword').value = '';
        document.getElementById('registerConfirm').value = '';
        showNotification(`‚úì Account created for ${data.name}!`, 'success');
      } catch (err) {
        errorEl.textContent = '‚ùå Could not reach server. Please try again.';
        errorEl.style.display = 'block';
      }
    });

    // =============================================
    // ADMIN LOGIN ‚Äî kept local (only you know this)
    // =============================================
    document.getElementById('adminLoginBtn').addEventListener('click', () => {
      const username = document.getElementById('adminUsername').value;
      const password = document.getElementById('adminPassword').value;
      if (username === 'admin' && password === 'admin@AISH2026') {
        currentUser = { role: 'admin', name: 'Administrator', icon: '‚öô' };
        loginUser();
      } else {
        document.getElementById('adminError').style.display = 'block';
        showNotification('‚ùå Access denied', 'error');
      }
    });

    // Location Detection
    function detectLocation() {
      const btn = document.getElementById('detectLocationBtn');
      const info = document.getElementById('locationInfo');
      
      if (!navigator.geolocation) {
        showNotification('‚ùå Geolocation not supported', 'error');
        return;
      }

      btn.disabled = true;
      btn.textContent = 'üîÑ Detecting...';
      info.classList.remove('show');

      navigator.geolocation.getCurrentPosition(
        async (position) => {
          const lat = position.coords.latitude;
          const lng = position.coords.longitude;
          
          // Store coordinates
          document.getElementById('patientLat').value = lat;
          document.getElementById('patientLng').value = lng;

          // Reverse geocode to get location name
          try {
            const response = await fetch(
              `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&zoom=10`
            );
            const data = await response.json();
            
            const locationName = data.address.city || data.address.town || 
                                data.address.village || data.address.county || 
                                'Unknown Location';
            
            document.getElementById('patientLocation').value = locationName;
            
            info.innerHTML = `
              <strong>‚úì Location Detected</strong><br>
              üìç ${locationName}<br>
              üåê Coordinates: ${lat.toFixed(4)}, ${lng.toFixed(4)}
            `;
            info.classList.add('show');
            
            showNotification('‚úì Location detected successfully', 'success');
          } catch (error) {
            console.error('Geocoding error:', error);
            document.getElementById('patientLocation').value = `Lat: ${lat.toFixed(4)}, Lng: ${lng.toFixed(4)}`;
            info.innerHTML = `
              <strong>‚úì GPS Detected</strong><br>
              üåê ${lat.toFixed(4)}, ${lng.toFixed(4)}
            `;
            info.classList.add('show');
            showNotification('‚úì GPS coordinates captured', 'success');
          }
          
          btn.disabled = false;
          btn.textContent = 'üìç Detect My Location';
        },
        (error) => {
          btn.disabled = false;
          btn.textContent = 'üìç Detect My Location';
          
          let message = 'Location detection failed';
          if (error.code === 1) message = '‚ùå Location access denied';
          else if (error.code === 2) message = '‚ùå Location unavailable';
          else if (error.code === 3) message = '‚ùå Location timeout';
          
          showNotification(message, 'error');
        },
        {
          enableHighAccuracy: true,
          timeout: 10000,
          maximumAge: 0
        }
      );
    }

    // Geocode entered location
    async function geocodeLocation(locationName) {
      if (!locationName) return null;
      
      try {
        const response = await fetch(
          `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(locationName)},India&limit=1`
        );
        const data = await response.json();
        
        if (data && data.length > 0) {
          return {
            lat: parseFloat(data[0].lat),
            lng: parseFloat(data[0].lon),
            displayName: data[0].display_name
          };
        }
      } catch (error) {
        console.error('Geocoding error:', error);
      }
      return null;
    }

    // Logout
    document.getElementById('logoutBtn').addEventListener('click', () => {
      document.getElementById('loginModal').classList.add('active');
      document.getElementById('userBadge').style.display = 'none';
      document.getElementById('adminBtn').style.display = 'none';
      document.getElementById('actionsHeader').style.display = 'none';
      document.getElementById('characterSelect').style.display = 'grid';
      document.getElementById('adminLoginForm').style.display = 'none';
      document.getElementById('doctorLoginForm').style.display = 'none';
      currentUser = null;
      saveToStorage('currentUser', null);
      renderCaseTable();
      showNotification('‚úì Session terminated', 'success');
    });

    // Switch role
    document.getElementById('switchRoleBtn').addEventListener('click', () => {
      document.getElementById('logoutBtn').click();
    });

    // Navigation
    document.querySelectorAll('.nav-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        switchTab(btn.getAttribute('data-tab'));
      });
    });

    // Symptom selection
    document.querySelectorAll('.symptom-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        btn.classList.toggle('selected');
        const selected = Array.from(document.querySelectorAll('.symptom-btn.selected'))
          .map(b => b.getAttribute('data-symptom'));
        document.getElementById('selectedSymptoms').value = selected.join(', ');
      });
    });

    // Report form
    document.getElementById('reportForm').addEventListener('submit', async (e) => {
      e.preventDefault();

      // Double-lock: block observers even if they somehow see the form
      if (!currentUser || currentUser.role === 'viewer') {
        showNotification('‚ùå Observers cannot report cases', 'error');
        updateReportTabVisibility();
        return;
      }

      const symptoms = document.getElementById('selectedSymptoms').value;
      
      if (!symptoms) {
        showNotification('‚ùå Please select at least one symptom', 'error');
        return;
      }

      const locationName = document.getElementById('patientLocation').value;
      let lat = document.getElementById('patientLat').value;
      let lng = document.getElementById('patientLng').value;

      // If coordinates not available, try to geocode the location
      if (!lat || !lng) {
        const geoData = await geocodeLocation(locationName);
        if (geoData) {
          lat = geoData.lat;
          lng = geoData.lng;
        }
      }

      const newCase = {
        name: document.getElementById('patientName').value,
        age: parseInt(document.getElementById('patientAge').value),
        location: locationName,
        lat: lat ? parseFloat(lat) : null,
        lng: lng ? parseFloat(lng) : null,
        symptoms: symptoms,
        waterSource: document.getElementById('waterSource').value,
        severity: document.getElementById('severity').value,
        date: new Date().toLocaleDateString('en-US', { month: 'short', day: 'numeric' }),
        status: 'Active',
        timestamp: new Date().toISOString(),
        synced: isOnline,
        userId: currentUser ? currentUser.email : null
      };

      // Try to save to MongoDB
      if (isOnline) {
        try {
          await createCase(newCase);
          showNotification('‚úì Case reported and synced to database', 'success');
          await fetchAllCases(); // re-fetch so all users see fresh data instantly
        } catch (error) {
          // Fallback to local storage
          cases.push(newCase);
          syncQueue.push(newCase);
          saveToStorage('syncQueue', syncQueue);
          saveToStorage('healthCases', cases);
          updateDashboard(); renderCaseTable(); updateMapMarkers();
          showNotification('‚ö† Case saved locally (will sync when server is available)', 'warning');
        }
      } else {
        cases.push(newCase);
        syncQueue.push(newCase);
        saveToStorage('syncQueue', syncQueue);
        saveToStorage('healthCases', cases);
        updateDashboard(); renderCaseTable(); updateMapMarkers();
        showNotification('‚ö† Case saved locally (will sync when online)', 'warning');
      }
      
      document.getElementById('reportForm').reset();
      document.querySelectorAll('.symptom-btn').forEach(b => b.classList.remove('selected'));
      document.getElementById('locationInfo').classList.remove('show');
      document.getElementById('patientLat').value = '';
      document.getElementById('patientLng').value = '';
      
      switchTab('dashboard');
    });

    // Mark default rows
    document.querySelectorAll('#caseTableBody tr').forEach(row => {
      row.classList.add('default-case');
    });

    // Load saved data
    const savedUser = loadFromStorage('currentUser');
    if (savedUser) {
      currentUser = savedUser;
      document.getElementById('loginModal').classList.remove('active');
      document.getElementById('userBadge').style.display = 'flex';
      document.getElementById('userIcon').textContent = currentUser.icon;
      document.getElementById('userName').textContent = currentUser.name;
      if (currentUser.role === 'admin') {
        document.getElementById('adminBtn').style.display = 'block';
        document.getElementById('actionsHeader').style.display = 'table-cell';
      }
      updateReportTabVisibility();
    }

    // Check server connection and load cases
    (async function initializeApp() {
      console.log('üîÑ Initializing AISH Health System...');
      
      // Try to connect to server
      const connected = await checkServerConnection();
      
      if (connected && isOnline) {
        console.log('‚úì Loading data from MongoDB...');
        try {
          await fetchAllCases();
          showNotification('‚úì Connected to database', 'success');
        } catch (error) {
          console.warn('Failed to fetch from MongoDB, using local data');
          cases = loadFromStorage('healthCases') || [];
          updateDashboard();
          renderCaseTable();
          updateMapMarkers(); updateAnalytics();
        }
      } else {
        console.log('üì± Backend not available, using offline mode');
        cases = loadFromStorage('healthCases') || [];
        updateDashboard();
        renderCaseTable();
        updateMapMarkers(); updateAnalytics();
        
        // Show helpful message in console only
        const backendMsg = `
          ‚ö†Ô∏è Backend Server Not Connected
          
          The system is working in offline mode.
          
          To enable cross-device sync:
          1. Make sure MongoDB is running
          2. Start the backend server: npm start
          3. Refresh this page
          
          You can still use all features locally!
        `;
        console.info(backendMsg);
      }
    })();

    // Load preferred language
    const savedLang = loadFromStorage('preferredLanguage');
    if (savedLang && translations[savedLang]) {
      currentLanguage = savedLang;
    }
    updateProtocolsDisplay();

    // Online/Offline Status Management
    function updateOnlineStatus() {
      isOnline = navigator.onLine;
      const statusEl = document.getElementById('systemStatus');
      const statusDot = document.getElementById('statusDot');
      const statusText = document.getElementById('statusText');
      
      if (isOnline) {
        statusEl.classList.remove('offline');
        statusDot.classList.remove('offline');
        statusText.classList.remove('offline');
        statusText.textContent = 'System Online';
        syncQueuedData();
      } else {
        statusEl.classList.add('offline');
        statusDot.classList.add('offline');
        statusText.classList.add('offline');
        statusText.textContent = 'Offline Mode';
      }
    }

    // Sync queued data when coming online
    async function syncQueuedData() {
      const queue = loadFromStorage('syncQueue') || [];
      if (queue.length > 0) {
        showNotification(`üîÑ Syncing ${queue.length} pending cases to database...`, 'info');
        
        try {
          await syncQueuedCasesToMongoDB();
        } catch (error) {
          showNotification('‚ö† Sync failed, will retry later', 'warning');
        }
      }
    }

    // Monitor online/offline status
    window.addEventListener('online', () => {
      updateOnlineStatus();
      showNotification('‚úì Connection restored', 'success');
    });

    window.addEventListener('offline', () => {
      updateOnlineStatus();
    });

    // Initial status check
    updateOnlineStatus();

    // Download Dashboard Report
    function downloadDashboard() {
      const stats = {
        totalCases: cases.length,
        activeCases: cases.filter(c => c.status === 'Active').length,
        recoveredCases: cases.filter(c => c.status === 'Recovered').length,
        criticalCases: cases.filter(c => c.severity === 'High').length
      };

      let content = `AISH HEALTH MONITORING SYSTEM
AI-Powered Disease Surveillance Dashboard
Generated: ${new Date().toLocaleString()}
${'-'.repeat(60)}

OVERALL STATISTICS
${'-'.repeat(60)}
Total Cases Reported: ${stats.totalCases}
Active Cases: ${stats.activeCases}
Recovered Cases: ${stats.recoveredCases}
Critical Cases: ${stats.criticalCases}

${'-'.repeat(60)}
RECENT CASES SUMMARY
${'-'.repeat(60)}
`;

      cases.slice(-10).reverse().forEach((c, i) => {
        content += `
${i + 1}. ${c.name} (Age: ${c.age})
   Location: ${c.location}${c.lat && c.lng ? ` (${c.lat.toFixed(4)}, ${c.lng.toFixed(4)})` : ''}
   Symptoms: ${c.symptoms}
   Severity: ${c.severity}
   Status: ${c.status}
   Date: ${c.date}
   Water Source: ${c.waterSource}
   Synced: ${c.synced ? 'Yes' : 'Pending'}
${'-'.repeat(60)}`;
      });

      content += `

DISEASE DISTRIBUTION
${'-'.repeat(60)}
`;

      const diseaseCount = {};
      cases.forEach(c => {
        const symptoms = c.symptoms.toLowerCase();
        if (symptoms.includes('diarrhea') || symptoms.includes('vomiting')) {
          diseaseCount['Cholera/Gastroenteritis'] = (diseaseCount['Cholera/Gastroenteritis'] || 0) + 1;
        }
        if (symptoms.includes('fever')) {
          diseaseCount['Typhoid/Fever'] = (diseaseCount['Typhoid/Fever'] || 0) + 1;
        }
        if (symptoms.includes('abdominal')) {
          diseaseCount['Dysentery'] = (diseaseCount['Dysentery'] || 0) + 1;
        }
      });

      Object.entries(diseaseCount).forEach(([disease, count]) => {
        content += `${disease}: ${count} cases\n`;
      });

      content += `
${'-'.repeat(60)}
SYSTEM INFORMATION
${'-'.repeat(60)}
Report Generated By: AISH System
AI Model: Active
Connection Status: ${isOnline ? 'Online' : 'Offline'}
Data Source: Real-time monitoring
Contact: emergency@aish-health.org
${'-'.repeat(60)}

This report is confidential and intended for authorized personnel only.
`;

      downloadFile(content, `AISH_Dashboard_Report_${new Date().toISOString().split('T')[0]}.txt`, 'text/plain');
      showNotification('‚úì Dashboard report downloaded', 'success');
    }

    // Download Case Registry as CSV
    function downloadRegistry() {
      let csv = 'Patient Name,Age,Location,Latitude,Longitude,Symptoms,Water Source,Severity,Date,Status,Synced,Timestamp\n';
      
      cases.forEach(c => {
        csv += `"${c.name}","${c.age}","${c.location}","${c.lat || ''}","${c.lng || ''}","${c.symptoms}","${c.waterSource}","${c.severity}","${c.date}","${c.status}","${c.synced ? 'Yes' : 'Pending'}","${c.timestamp || ''}"\n`;
      });

      downloadFile(csv, `AISH_Case_Registry_${new Date().toISOString().split('T')[0]}.csv`, 'text/csv');
      showNotification('‚úì Case registry downloaded', 'success');
    }

    // Helper function to trigger file download
    function downloadFile(content, filename, mimeType) {
      const blob = new Blob([content], { type: mimeType });
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      window.URL.revokeObjectURL(url);
      document.body.removeChild(a);
    }

    // ========================================
    // AISH CHATBOT - MULTILINGUAL RULE-BASED AI
    // ========================================
    
    let chatLanguage = 'en';
    
    const chatKnowledgeBase = {
      en: {
        cholera: {
          keywords: ['cholera', 'vibrio', 'rice water', 'severe diarrhea'],
          response: `**Cholera - Key Information:**

üìã **What is Cholera?**
Cholera is an acute diarrheal infection caused by Vibrio cholerae bacteria, transmitted through contaminated water and food.

üî¨ **Symptoms:**
‚Ä¢ Severe watery diarrhea ("rice-water stools")
‚Ä¢ Vomiting
‚Ä¢ Rapid dehydration
‚Ä¢ Muscle cramps
‚Ä¢ Low blood pressure

‚ö†Ô∏è **Risk Factors:**
‚Ä¢ Contaminated water sources
‚Ä¢ Poor sanitation
‚Ä¢ Crowded living conditions
‚Ä¢ Raw/undercooked seafood

üíä **Treatment:**
‚Ä¢ Immediate oral rehydration solution (ORS)
‚Ä¢ Intravenous fluids for severe cases
‚Ä¢ Antibiotics (as prescribed)
‚Ä¢ Zinc supplements

üõ°Ô∏è **Prevention:**
‚Ä¢ Drink only safe, treated water
‚Ä¢ Wash hands frequently
‚Ä¢ Cook food thoroughly
‚Ä¢ Use proper sanitation facilities

‚öïÔ∏è **Seek immediate medical help if symptoms appear!**`
        },
        typhoid: {
          keywords: ['typhoid', 'enteric fever', 'salmonella', 'prolonged fever'],
          response: `**Typhoid Fever - Essential Guide:**

üìã **What is Typhoid?**
Typhoid is a bacterial infection caused by Salmonella typhi, spread through contaminated food and water.

üå°Ô∏è **Symptoms:**
‚Ä¢ Prolonged high fever (103-104¬∞F)
‚Ä¢ Headache and weakness
‚Ä¢ Stomach pain
‚Ä¢ Loss of appetite
‚Ä¢ Rose-colored spots on chest
‚Ä¢ Constipation or diarrhea

‚è±Ô∏è **Timeline:**
Symptoms appear 6-30 days after exposure, typically lasting 3-4 weeks without treatment.

üíä **Treatment:**
‚Ä¢ Antibiotics (Ciprofloxacin, Ceftriaxone)
‚Ä¢ Complete the full antibiotic course
‚Ä¢ Rest and adequate nutrition
‚Ä¢ Fever management
‚Ä¢ Hospital care for severe cases

üõ°Ô∏è **Prevention:**
‚Ä¢ Typhoid vaccination
‚Ä¢ Safe drinking water
‚Ä¢ Good hygiene practices
‚Ä¢ Avoid raw foods
‚Ä¢ Wash fruits and vegetables

üìû **Emergency:** If fever exceeds 104¬∞F or symptoms worsen, seek immediate medical attention!`
        },
        dysentery: {
          keywords: ['dysentery', 'bloody diarrhea', 'shigella', 'intestinal infection'],
          response: `**Dysentery - Complete Information:**

üìã **What is Dysentery?**
Dysentery is intestinal inflammation causing severe diarrhea with blood and mucus, caused by bacteria (Shigella) or parasites (Entamoeba).

üíâ **Symptoms:**
‚Ä¢ Bloody or mucus-containing diarrhea
‚Ä¢ Severe abdominal cramps
‚Ä¢ Fever and chills
‚Ä¢ Nausea and vomiting
‚Ä¢ Dehydration
‚Ä¢ Painful bowel movements

ü¶† **Types:**
1. **Bacterial (Shigellosis):** More common, acute onset
2. **Amoebic:** Caused by parasites, may be chronic

üíä **Treatment:**
‚Ä¢ Oral rehydration therapy (ORS)
‚Ä¢ Antibiotics for bacterial dysentery
‚Ä¢ Antiparasitic medications for amoebic
‚Ä¢ Avoid anti-diarrheal medications
‚Ä¢ Maintain fluid intake

üõ°Ô∏è **Prevention:**
‚Ä¢ Hand washing with soap
‚Ä¢ Safe food and water
‚Ä¢ Proper sanitation
‚Ä¢ Avoid contaminated sources
‚Ä¢ Personal hygiene

‚öïÔ∏è **Seek medical care immediately if you see blood in stools!**`
        },
        prevention: {
          keywords: ['prevent', 'prevention', 'avoid', 'protect', 'safety'],
          response: `**Waterborne Disease Prevention Guide:**

üíß **Safe Water Practices:**
‚Ä¢ Boil water for at least 1 minute
‚Ä¢ Use water purification tablets
‚Ä¢ Install proper water filters
‚Ä¢ Store water in clean, covered containers
‚Ä¢ Avoid stagnant water sources

üßº **Hygiene Essentials:**
‚Ä¢ Wash hands with soap before eating
‚Ä¢ Wash hands after using toilet
‚Ä¢ Keep nails clean and trimmed
‚Ä¢ Use hand sanitizer when soap unavailable
‚Ä¢ Avoid touching face with unwashed hands

üç≤ **Food Safety:**
‚Ä¢ Cook food thoroughly (especially meat and fish)
‚Ä¢ Wash fruits and vegetables
‚Ä¢ Avoid street food in high-risk areas
‚Ä¢ Use clean utensils
‚Ä¢ Refrigerate perishable food

üè• **Health Measures:**
‚Ä¢ Get vaccinated (Cholera, Typhoid)
‚Ä¢ Take prophylactic medications when traveling
‚Ä¢ Build immunity with proper nutrition
‚Ä¢ Regular health check-ups

üöΩ **Sanitation:**
‚Ä¢ Use proper toilets
‚Ä¢ Maintain clean surroundings
‚Ä¢ Dispose waste properly
‚Ä¢ Keep water sources protected
‚Ä¢ Report contamination immediately

‚úÖ **Remember:** Prevention is always better than cure!`
        },
        symptoms: {
          keywords: ['symptom', 'signs', 'feeling', 'sick', 'ill'],
          response: `**Common Waterborne Disease Symptoms:**

üö® **Warning Signs to Watch For:**

**Immediate Symptoms (0-24 hours):**
‚Ä¢ Nausea and vomiting
‚Ä¢ Stomach cramps
‚Ä¢ Watery diarrhea
‚Ä¢ Mild fever

**Moderate Symptoms (1-3 days):**
‚Ä¢ Persistent diarrhea
‚Ä¢ Fever (100-102¬∞F)
‚Ä¢ Headache
‚Ä¢ Muscle aches
‚Ä¢ Loss of appetite
‚Ä¢ Fatigue

**Severe Symptoms (Seek Emergency Care):**
‚Ä¢ üö® Bloody diarrhea
‚Ä¢ üö® High fever (>103¬∞F)
‚Ä¢ üö® Severe dehydration (dry mouth, no urination)
‚Ä¢ üö® Rapid heartbeat
‚Ä¢ üö® Confusion or dizziness
‚Ä¢ üö® Inability to keep liquids down

üíß **Dehydration Signs:**
‚Ä¢ Extreme thirst
‚Ä¢ Dry skin and mouth
‚Ä¢ Dark urine
‚Ä¢ Sunken eyes
‚Ä¢ Reduced urination
‚Ä¢ Dizziness

‚öïÔ∏è **Action Steps:**
1. Start ORS immediately
2. Rest and avoid solid food initially
3. Monitor temperature
4. Seek medical help if symptoms worsen
5. Report case to local health authorities

**When in doubt, always consult a healthcare provider!**`
        },
        treatment: {
          keywords: ['treatment', 'cure', 'medicine', 'therapy', 'treat'],
          response: `**Waterborne Disease Treatment Protocol:**

üíä **First-Line Treatment:**

**1. Rehydration (MOST IMPORTANT):**
‚Ä¢ Oral Rehydration Solution (ORS)
‚Ä¢ Recipe: 1 liter water + 6 teaspoons sugar + 1/2 teaspoon salt
‚Ä¢ Drink small amounts frequently
‚Ä¢ Continue even if vomiting
‚Ä¢ IV fluids for severe dehydration

**2. Medications:**
‚Ä¢ Antibiotics (only as prescribed by doctor)
  - Ciprofloxacin for typhoid
  - Azithromycin for cholera
  - Metronidazole for dysentery
‚Ä¢ Zinc supplements (for children)
‚Ä¢ Probiotics (to restore gut health)
‚Ä¢ Fever reducers (Paracetamol/Acetaminophen)

**3. Dietary Management:**
‚Ä¢ BRAT diet (Bananas, Rice, Applesauce, Toast)
‚Ä¢ Clear fluids
‚Ä¢ Avoid dairy products initially
‚Ä¢ Gradually return to normal diet
‚Ä¢ Small, frequent meals

**4. Rest and Recovery:**
‚Ä¢ Complete bed rest
‚Ä¢ Avoid physical exertion
‚Ä¢ Stay home to prevent spread
‚Ä¢ Maintain personal hygiene

‚ö†Ô∏è **DO NOT:**
‚Ä¢ Self-medicate with antibiotics
‚Ä¢ Use anti-diarrheal medications without doctor's advice
‚Ä¢ Stop antibiotics mid-course
‚Ä¢ Share medications
‚Ä¢ Ignore worsening symptoms

üìû **Emergency Contacts:**
‚Ä¢ National Health Helpline: 104
‚Ä¢ Ambulance: 108
‚Ä¢ Emergency: 112

**Always complete the full course of treatment as prescribed!**`
        },
        emergency: {
          keywords: ['emergency', 'urgent', 'help', 'serious', 'critical', 'ambulance'],
          response: `**üö® EMERGENCY CONTACTS & PROTOCOLS:**

**Immediate Emergency Numbers:**
üìû **Ambulance:** 108 / 102
üìû **National Health Helpline:** 104 / 1075
üìû **Emergency Services:** 112
üìû **Poison Control:** 1066

**When to Call Emergency Services:**
üö® **Life-Threatening Signs:**
‚Ä¢ Unconsciousness or confusion
‚Ä¢ Severe breathing difficulty
‚Ä¢ Chest pain
‚Ä¢ Uncontrollable bleeding
‚Ä¢ Seizures
‚Ä¢ Extreme dehydration (no urination for 12+ hours)
‚Ä¢ Fever above 104¬∞F (40¬∞C)

**Before Emergency Arrives:**
1. ‚úÖ Keep patient comfortable
2. ‚úÖ Monitor vital signs
3. ‚úÖ Continue ORS if conscious
4. ‚úÖ Note symptoms and timeline
5. ‚úÖ Have medical history ready
6. ‚úÖ Clear path for emergency responders

**Nearest Facilities:**
‚Ä¢ Check AISH system dashboard for outbreak locations
‚Ä¢ Contact nearest primary health center
‚Ä¢ Government hospitals provide free treatment
‚Ä¢ Keep list of nearby pharmacies

**Disease-Specific Emergencies:**
‚Ä¢ **Cholera:** Severe dehydration within hours
‚Ä¢ **Typhoid:** Intestinal bleeding/perforation
‚Ä¢ **Dysentery:** Severe bloody diarrhea

‚öïÔ∏è **Remember:** Early medical intervention saves lives!

**For non-emergencies, consult local health workers or use telemedicine services.**`
        },
        water: {
          keywords: ['water', 'purification', 'clean', 'safe', 'treatment', 'boil'],
          response: `**Water Purification & Safety Guide:**

üíß **Water Treatment Methods:**

**1. Boiling (Most Effective):**
‚Ä¢ Boil for 1 minute at sea level
‚Ä¢ Boil for 3 minutes at high altitude
‚Ä¢ Let cool before drinking
‚Ä¢ ‚úÖ Kills all bacteria, viruses, parasites

**2. Chemical Treatment:**
‚Ä¢ Chlorine tablets (follow instructions)
‚Ä¢ Iodine drops (2 drops per liter)
‚Ä¢ Wait 30 minutes before drinking
‚Ä¢ ‚úÖ Effective against most pathogens

**3. Filtration:**
‚Ä¢ Ceramic filters (0.2-0.5 micron)
‚Ä¢ Activated carbon filters
‚Ä¢ UV water purifiers
‚Ä¢ Reverse osmosis systems
‚Ä¢ ‚úÖ Removes physical contaminants

**4. Solar Disinfection (SODIS):**
‚Ä¢ Fill clear bottles with water
‚Ä¢ Place in direct sunlight for 6 hours
‚Ä¢ ‚úÖ Free and effective for small quantities

**Safe Water Storage:**
‚Ä¢ Use clean, covered containers
‚Ä¢ Don't touch water with hands
‚Ä¢ Use a long-handled ladle
‚Ä¢ Clean containers weekly
‚Ä¢ Store in cool, dark place

**Water Source Safety:**
‚Ä¢ Avoid stagnant water
‚Ä¢ Protect wells with covers
‚Ä¢ Keep animals away from sources
‚Ä¢ Test water quality regularly
‚Ä¢ Report contamination immediately

**Testing Water Quality:**
‚Ä¢ Visual inspection (clear, no odor)
‚Ä¢ TDS meter testing
‚Ä¢ Bacterial testing kits
‚Ä¢ Contact local health department

üí° **Quick Tip:** When in doubt about water safety, always boil it!`
        }
      },
      hi: {
        cholera: {
          keywords: ['‡§π‡•à‡§ú‡§æ', 'cholera', '‡§¶‡§∏‡•ç‡§§', '‡§â‡§≤‡•ç‡§ü‡•Ä'],
          response: `**‡§π‡•à‡§ú‡§æ - ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä:**

üìã **‡§π‡•à‡§ú‡§æ ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à?**
‡§π‡•à‡§ú‡§æ ‡§µ‡§ø‡§¨‡•ç‡§∞‡§ø‡§Ø‡•ã ‡§ï‡•â‡§≤‡•á‡§∞‡•Ä ‡§¨‡•à‡§ï‡•ç‡§ü‡•Ä‡§∞‡§ø‡§Ø‡§æ ‡§∏‡•á ‡§π‡•ã‡§®‡•á ‡§µ‡§æ‡§≤‡§æ ‡§è‡§ï ‡§ó‡§Ç‡§≠‡•Ä‡§∞ ‡§∏‡§Ç‡§ï‡•ç‡§∞‡§Æ‡§£ ‡§π‡•à ‡§ú‡•ã ‡§¶‡•Ç‡§∑‡§ø‡§§ ‡§™‡§æ‡§®‡•Ä ‡§î‡§∞ ‡§≠‡•ã‡§ú‡§® ‡§∏‡•á ‡§´‡•à‡§≤‡§§‡§æ ‡§π‡•à‡•§

üî¨ **‡§≤‡§ï‡•ç‡§∑‡§£:**
‚Ä¢ ‡§ó‡§Ç‡§≠‡•Ä‡§∞ ‡§™‡§æ‡§®‡•Ä ‡§ú‡•à‡§∏‡§æ ‡§¶‡§∏‡•ç‡§§
‚Ä¢ ‡§â‡§≤‡•ç‡§ü‡•Ä
‚Ä¢ ‡§§‡•á‡§ú‡•Ä ‡§∏‡•á ‡§®‡§ø‡§∞‡•ç‡§ú‡§≤‡•Ä‡§ï‡§∞‡§£
‚Ä¢ ‡§Æ‡§æ‡§Ç‡§∏‡§™‡•á‡§∂‡§ø‡§Ø‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§ê‡§Ç‡§†‡§®
‚Ä¢ ‡§ï‡§Æ ‡§∞‡§ï‡•ç‡§§‡§ö‡§æ‡§™

üíä **‡§â‡§™‡§ö‡§æ‡§∞:**
‚Ä¢ ‡§§‡•Å‡§∞‡§Ç‡§§ ORS (‡§Æ‡•å‡§ñ‡§ø‡§ï ‡§™‡•Å‡§®‡§∞‡•ç‡§ú‡§≤‡•Ä‡§ï‡§∞‡§£ ‡§∏‡§Æ‡§æ‡§ß‡§æ‡§®)
‚Ä¢ ‡§ó‡§Ç‡§≠‡•Ä‡§∞ ‡§Æ‡§æ‡§Æ‡§≤‡•ã‡§Ç ‡§Æ‡•á‡§Ç IV ‡§§‡§∞‡§≤ ‡§™‡§¶‡§æ‡§∞‡•ç‡§•
‚Ä¢ ‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§®‡§ø‡§∞‡•ç‡§ß‡§æ‡§∞‡§ø‡§§ ‡§è‡§Ç‡§ü‡•Ä‡§¨‡§æ‡§Ø‡•ã‡§ü‡§ø‡§ï‡•ç‡§∏
‚Ä¢ ‡§ú‡§ø‡§Ç‡§ï ‡§∏‡§™‡•ç‡§≤‡•Ä‡§Æ‡•á‡§Ç‡§ü

üõ°Ô∏è **‡§∞‡•ã‡§ï‡§•‡§æ‡§Æ:**
‚Ä¢ ‡§ï‡•á‡§µ‡§≤ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§, ‡§â‡§¨‡§≤‡§æ ‡§™‡§æ‡§®‡•Ä ‡§™‡§ø‡§è‡§Ç
‚Ä¢ ‡§¨‡§æ‡§∞-‡§¨‡§æ‡§∞ ‡§π‡§æ‡§• ‡§ß‡•ã‡§è‡§Ç
‚Ä¢ ‡§≠‡•ã‡§ú‡§® ‡§ï‡•ã ‡§Ö‡§ö‡•ç‡§õ‡•Ä ‡§§‡§∞‡§π ‡§™‡§ï‡§æ‡§è‡§Ç
‚Ä¢ ‡§â‡§ö‡§ø‡§§ ‡§∏‡•ç‡§µ‡§ö‡•ç‡§õ‡§§‡§æ ‡§∏‡•Å‡§µ‡§ø‡§ß‡§æ‡§ì‡§Ç ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç

‚öïÔ∏è **‡§≤‡§ï‡•ç‡§∑‡§£ ‡§¶‡§ø‡§ñ‡§®‡•á ‡§™‡§∞ ‡§§‡•Å‡§∞‡§Ç‡§§ ‡§ö‡§ø‡§ï‡§ø‡§§‡•ç‡§∏‡§æ ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§≤‡•á‡§Ç!**`
        },
        prevention: {
          keywords: ['‡§∞‡•ã‡§ï‡§•‡§æ‡§Æ', '‡§¨‡§ö‡§æ‡§µ', '‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ', 'prevent'],
          response: `**‡§ú‡§≤-‡§ú‡§®‡§ø‡§§ ‡§∞‡•ã‡§ó ‡§∞‡•ã‡§ï‡§•‡§æ‡§Æ ‡§Æ‡§æ‡§∞‡•ç‡§ó‡§¶‡§∞‡•ç‡§∂‡§ø‡§ï‡§æ:**

üíß **‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§™‡§æ‡§®‡•Ä:**
‚Ä¢ ‡§™‡§æ‡§®‡•Ä ‡§ï‡•ã ‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ 1 ‡§Æ‡§ø‡§®‡§ü ‡§§‡§ï ‡§â‡§¨‡§æ‡§≤‡•á‡§Ç
‚Ä¢ ‡§µ‡•â‡§ü‡§∞ ‡§™‡•ç‡§Ø‡•Ç‡§∞‡•Ä‡§´‡§ø‡§ï‡•á‡§∂‡§® ‡§ü‡•à‡§¨‡§≤‡•á‡§ü ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç
‚Ä¢ ‡§™‡§æ‡§®‡•Ä ‡§ï‡•ã ‡§∏‡§æ‡§´, ‡§¢‡§ï‡•á ‡§π‡•Å‡§è ‡§¨‡§∞‡•ç‡§§‡§®‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§∞‡§ñ‡•á‡§Ç

üßº **‡§∏‡•ç‡§µ‡§ö‡•ç‡§õ‡§§‡§æ:**
‚Ä¢ ‡§ñ‡§æ‡§®‡•á ‡§∏‡•á ‡§™‡§π‡§≤‡•á ‡§∏‡§æ‡§¨‡•Å‡§® ‡§∏‡•á ‡§π‡§æ‡§• ‡§ß‡•ã‡§è‡§Ç
‚Ä¢ ‡§∂‡•å‡§ö‡§æ‡§≤‡§Ø ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§π‡§æ‡§• ‡§ß‡•ã‡§è‡§Ç
‚Ä¢ ‡§ö‡•á‡§π‡§∞‡•á ‡§ï‡•ã ‡§ó‡§Ç‡§¶‡•á ‡§π‡§æ‡§•‡•ã‡§Ç ‡§∏‡•á ‡§® ‡§õ‡•Å‡§è‡§Ç

üç≤ **‡§ñ‡§æ‡§¶‡•ç‡§Ø ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ:**
‚Ä¢ ‡§≠‡•ã‡§ú‡§® ‡§ï‡•ã ‡§Ö‡§ö‡•ç‡§õ‡•Ä ‡§§‡§∞‡§π ‡§™‡§ï‡§æ‡§è‡§Ç
‚Ä¢ ‡§´‡§≤ ‡§î‡§∞ ‡§∏‡§¨‡•ç‡§ú‡§ø‡§Ø‡§æ‡§Ç ‡§ß‡•ã‡§è‡§Ç
‚Ä¢ ‡§¨‡§æ‡§∏‡•Ä ‡§≠‡•ã‡§ú‡§® ‡§® ‡§ñ‡§æ‡§è‡§Ç

üè• **‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø ‡§â‡§™‡§æ‡§Ø:**
‚Ä¢ ‡§ü‡•Ä‡§ï‡§æ‡§ï‡§∞‡§£ ‡§ï‡§∞‡§æ‡§è‡§Ç
‚Ä¢ ‡§®‡§ø‡§Ø‡§Æ‡§ø‡§§ ‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø ‡§ú‡§æ‡§Ç‡§ö
‚Ä¢ ‡§™‡•å‡§∑‡•ç‡§ü‡§ø‡§ï ‡§Ü‡§π‡§æ‡§∞ ‡§≤‡•á‡§Ç

‚úÖ **‡§Ø‡§æ‡§¶ ‡§∞‡§ñ‡•á‡§Ç:** ‡§∞‡•ã‡§ï‡§•‡§æ‡§Æ ‡§π‡§Æ‡•á‡§∂‡§æ ‡§á‡§≤‡§æ‡§ú ‡§∏‡•á ‡§¨‡•á‡§π‡§§‡§∞ ‡§π‡•à!`
        },
        emergency: {
          keywords: ['‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤', 'emergency', '‡§Æ‡§¶‡§¶', 'help'],
          response: `**üö® ‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤‡•Ä‡§® ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï:**

**‡§§‡§§‡•ç‡§ï‡§æ‡§≤ ‡§®‡§Ç‡§¨‡§∞:**
üìû **‡§è‡§Æ‡•ç‡§¨‡•Å‡§≤‡•á‡§Ç‡§∏:** 108 / 102
üìû **‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø ‡§π‡•á‡§≤‡•ç‡§™‡§≤‡§æ‡§á‡§®:** 104 / 1075
üìû **‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤‡•Ä‡§® ‡§∏‡•á‡§µ‡§æ‡§è‡§Ç:** 112

**‡§ï‡§¨ ‡§ï‡•â‡§≤ ‡§ï‡§∞‡•á‡§Ç:**
üö® ‡§¨‡•á‡§π‡•ã‡§∂‡•Ä ‡§Ø‡§æ ‡§≠‡•ç‡§∞‡§Æ
üö® ‡§ó‡§Ç‡§≠‡•Ä‡§∞ ‡§∏‡§æ‡§Ç‡§∏ ‡§≤‡•á‡§®‡•á ‡§Æ‡•á‡§Ç ‡§ï‡§†‡§ø‡§®‡§æ‡§à
üö® 104¬∞F ‡§∏‡•á ‡§ä‡§™‡§∞ ‡§¨‡•Å‡§ñ‡§æ‡§∞
üö® ‡§ó‡§Ç‡§≠‡•Ä‡§∞ ‡§®‡§ø‡§∞‡•ç‡§ú‡§≤‡•Ä‡§ï‡§∞‡§£

**‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤‡•Ä‡§® ‡§Ü‡§®‡•á ‡§∏‡•á ‡§™‡§π‡§≤‡•á:**
1. ‚úÖ ‡§∞‡•ã‡§ó‡•Ä ‡§ï‡•ã ‡§Ü‡§∞‡§æ‡§Æ ‡§¶‡•á‡§Ç
2. ‚úÖ ORS ‡§ú‡§æ‡§∞‡•Ä ‡§∞‡§ñ‡•á‡§Ç
3. ‚úÖ ‡§≤‡§ï‡•ç‡§∑‡§£ ‡§®‡•ã‡§ü ‡§ï‡§∞‡•á‡§Ç

‚öïÔ∏è **‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§ö‡§ø‡§ï‡§ø‡§§‡•ç‡§∏‡§æ ‡§π‡§∏‡•ç‡§§‡§ï‡•ç‡§∑‡•á‡§™ ‡§ú‡•Ä‡§µ‡§® ‡§¨‡§ö‡§æ‡§§‡§æ ‡§π‡•à!**`
        }
      },
      ta: {
        cholera: {
          keywords: ['‡Æï‡Ææ‡Æ≤‡Æ∞‡Ææ', 'cholera', '‡Æµ‡ÆØ‡Æø‡Æ±‡Øç‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Øã‡Æï‡Øç‡Æï‡ØÅ'],
          response: `**‡Æï‡Ææ‡Æ≤‡Æ∞‡Ææ - ‡ÆÆ‡ØÅ‡Æï‡Øç‡Æï‡Æø‡ÆØ ‡Æ§‡Æï‡Æµ‡Æ≤‡Øç:**

üìã **‡Æï‡Ææ‡Æ≤‡Æ∞‡Ææ ‡Æé‡Æ©‡Øç‡Æ±‡Ææ‡Æ≤‡Øç ‡Æé‡Æ©‡Øç‡Æ©?**
‡Æï‡Ææ‡Æ≤‡Æ∞‡Ææ ‡Æé‡Æ©‡Øç‡Æ™‡Æ§‡ØÅ ‡Æµ‡Æø‡Æ™‡Øç‡Æ∞‡Æø‡ÆØ‡Øã ‡Æï‡Ææ‡Æ≤‡Æ∞‡Øá ‡Æ™‡Ææ‡Æï‡Øç‡Æü‡ØÄ‡Æ∞‡Æø‡ÆØ‡Ææ‡Æµ‡Ææ‡Æ≤‡Øç ‡Æè‡Æ±‡Øç‡Æ™‡Æü‡ØÅ‡ÆÆ‡Øç ‡Æï‡Æü‡ØÅ‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ© ‡Æ§‡Øä‡Æ±‡Øç‡Æ±‡ØÅ ‡Æ®‡Øã‡ÆØ‡Ææ‡Æï‡ØÅ‡ÆÆ‡Øç.

üî¨ **‡ÆÖ‡Æ±‡Æø‡Æï‡ØÅ‡Æ±‡Æø‡Æï‡Æ≥‡Øç:**
‚Ä¢ ‡Æï‡Æü‡ØÅ‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ© ‡Æ®‡ØÄ‡Æ∞‡Øç ‡Æ™‡Øã‡Æ©‡Øç‡Æ± ‡Æµ‡ÆØ‡Æø‡Æ±‡Øç‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Øã‡Æï‡Øç‡Æï‡ØÅ
‚Ä¢ ‡Æµ‡Ææ‡Æ®‡Øç‡Æ§‡Æø
‚Ä¢ ‡Æµ‡Øá‡Æï‡ÆÆ‡Ææ‡Æ© ‡Æ®‡ØÄ‡Æ∞‡Æø‡Æ¥‡Æ™‡Øç‡Æ™‡ØÅ
‚Ä¢ ‡Æ§‡Æö‡Øà ‡Æ™‡Æø‡Æü‡Æø‡Æ™‡Øç‡Æ™‡ØÅ‡Æï‡Æ≥‡Øç
‚Ä¢ ‡Æï‡ØÅ‡Æ±‡Øà‡Æ®‡Øç‡Æ§ ‡Æá‡Æ∞‡Æ§‡Øç‡Æ§ ‡ÆÖ‡Æ¥‡ØÅ‡Æ§‡Øç‡Æ§‡ÆÆ‡Øç

üíä **‡Æö‡Æø‡Æï‡Æø‡Æö‡Øç‡Æö‡Øà:**
‚Ä¢ ‡Æâ‡Æü‡Æ©‡Æü‡Æø‡ÆØ‡Ææ‡Æï ORS
‚Ä¢ ‡Æï‡Æü‡ØÅ‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ© ‡Æ®‡ØÄ‡Æ∞‡Æø‡Æ¥‡Æ™‡Øç‡Æ™‡ØÅ‡Æï‡Øç‡Æï‡ØÅ IV ‡Æ§‡Æø‡Æ∞‡Æµ‡Æô‡Øç‡Æï‡Æ≥‡Øç
‚Ä¢ ‡ÆÆ‡Æ∞‡ØÅ‡Æ§‡Øç‡Æ§‡ØÅ‡Æµ‡Æ∞‡Øç ‡Æ™‡Æ∞‡Æø‡Æ®‡Øç‡Æ§‡ØÅ‡Æ∞‡Øà‡Æ§‡Øç‡Æ§ ‡Æ®‡ØÅ‡Æ£‡Øç‡Æ£‡ØÅ‡ÆØ‡Æø‡Æ∞‡Øç ‡Æé‡Æ§‡Æø‡Æ∞‡Øç‡Æ™‡Øç‡Æ™‡Æø‡Æï‡Æ≥‡Øç

üõ°Ô∏è **‡Æ§‡Æü‡ØÅ‡Æ™‡Øç‡Æ™‡ØÅ:**
‚Ä¢ ‡Æ™‡Ææ‡Æ§‡ØÅ‡Æï‡Ææ‡Æ™‡Øç‡Æ™‡Ææ‡Æ©, ‡Æï‡Øä‡Æ§‡Æø‡Æï‡Øç‡Æï‡Æµ‡Øà‡Æ§‡Øç‡Æ§ ‡Æ§‡Æ£‡Øç‡Æ£‡ØÄ‡Æ∞‡Øç ‡Æï‡ØÅ‡Æü‡Æø‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç
‚Ä¢ ‡ÆÖ‡Æü‡Æø‡Æï‡Øç‡Æï‡Æü‡Æø ‡Æï‡Øà‡Æï‡Æ≥‡Øà ‡Æï‡Æ¥‡ØÅ‡Æµ‡Æµ‡ØÅ‡ÆÆ‡Øç
‚Ä¢ ‡Æâ‡Æ£‡Æµ‡Øà ‡Æ®‡Æ©‡Øç‡Æ±‡Ææ‡Æï ‡Æö‡ÆÆ‡Øà‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç

‚öïÔ∏è **‡ÆÖ‡Æ±‡Æø‡Æï‡ØÅ‡Æ±‡Æø‡Æï‡Æ≥‡Øç ‡Æ§‡Øã‡Æ©‡Øç‡Æ±‡Æø‡Æ©‡Ææ‡Æ≤‡Øç ‡Æâ‡Æü‡Æ©‡Æü‡Æø‡ÆØ‡Ææ‡Æï ‡ÆÆ‡Æ∞‡ØÅ‡Æ§‡Øç‡Æ§‡ØÅ‡Æµ ‡Æâ‡Æ§‡Æµ‡Æø ‡Æ™‡ØÜ‡Æ±‡Æµ‡ØÅ‡ÆÆ‡Øç!**`
        },
        prevention: {
          keywords: ['‡Æ§‡Æü‡ØÅ‡Æ™‡Øç‡Æ™‡ØÅ', '‡Æ™‡Ææ‡Æ§‡ØÅ‡Æï‡Ææ‡Æ™‡Øç‡Æ™‡ØÅ', 'prevent'],
          response: `**‡Æ®‡ØÄ‡Æ∞‡Øç‡Æµ‡Æ¥‡Æø ‡Æ®‡Øã‡ÆØ‡Øç ‡Æ§‡Æü‡ØÅ‡Æ™‡Øç‡Æ™‡ØÅ ‡Æµ‡Æ¥‡Æø‡Æï‡Ææ‡Æü‡Øç‡Æü‡Æø:**

üíß **‡Æ™‡Ææ‡Æ§‡ØÅ‡Æï‡Ææ‡Æ™‡Øç‡Æ™‡Ææ‡Æ© ‡Æ®‡ØÄ‡Æ∞‡Øç:**
‚Ä¢ ‡Æï‡ØÅ‡Æ±‡Øà‡Æ®‡Øç‡Æ§‡Æ§‡ØÅ 1 ‡Æ®‡Æø‡ÆÆ‡Æø‡Æü‡ÆÆ‡Øç ‡Æ§‡Æ£‡Øç‡Æ£‡ØÄ‡Æ∞‡Øà ‡Æï‡Øä‡Æ§‡Æø‡Æï‡Øç‡Æï‡Æµ‡Øà‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç
‚Ä¢ ‡Æö‡ØÅ‡Æ§‡Øç‡Æ§‡Æø‡Æï‡Æ∞‡Æø‡Æ™‡Øç‡Æ™‡ØÅ ‡ÆÆ‡Ææ‡Æ§‡Øç‡Æ§‡Æø‡Æ∞‡Øà‡Æï‡Æ≥‡Øà ‡Æ™‡ÆØ‡Æ©‡Øç‡Æ™‡Æü‡ØÅ‡Æ§‡Øç‡Æ§‡Æµ‡ØÅ‡ÆÆ‡Øç
‚Ä¢ ‡Æ§‡Æ£‡Øç‡Æ£‡ØÄ‡Æ∞‡Øà ‡Æö‡ØÅ‡Æ§‡Øç‡Æ§‡ÆÆ‡Ææ‡Æ© ‡Æ™‡Ææ‡Æ§‡Øç‡Æ§‡Æø‡Æ∞‡Æô‡Øç‡Æï‡Æ≥‡Æø‡Æ≤‡Øç ‡Æö‡Øá‡ÆÆ‡Æø‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç

üßº **‡Æö‡ØÅ‡Æï‡Ææ‡Æ§‡Ææ‡Æ∞‡ÆÆ‡Øç:**
‚Ä¢ ‡Æö‡Ææ‡Æ™‡Øç‡Æ™‡Æø‡Æü‡ØÅ‡ÆÆ‡Øç ‡ÆÆ‡ØÅ‡Æ©‡Øç ‡Æö‡Øã‡Æ™‡Øç‡Æ™‡Ææ‡Æ≤‡Øç ‡Æï‡Øà‡Æï‡Æ≥‡Øà ‡Æï‡Æ¥‡ØÅ‡Æµ‡Æµ‡ØÅ‡ÆÆ‡Øç
‚Ä¢ ‡Æï‡Æ¥‡Æø‡Æµ‡Æ±‡Øà ‡Æ™‡ÆØ‡Æ©‡Øç‡Æ™‡Ææ‡Æü‡Øç‡Æü‡Æø‡Æ±‡Øç‡Æï‡ØÅ ‡Æ™‡Æø‡Æ±‡Æï‡ØÅ ‡Æï‡Øà‡Æï‡Æ≥‡Øà ‡Æï‡Æ¥‡ØÅ‡Æµ‡Æµ‡ØÅ‡ÆÆ‡Øç

üç≤ **‡Æâ‡Æ£‡Æµ‡ØÅ ‡Æ™‡Ææ‡Æ§‡ØÅ‡Æï‡Ææ‡Æ™‡Øç‡Æ™‡ØÅ:**
‚Ä¢ ‡Æâ‡Æ£‡Æµ‡Øà ‡Æ®‡Æ©‡Øç‡Æ±‡Ææ‡Æï ‡Æö‡ÆÆ‡Øà‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç
‚Ä¢ ‡Æ™‡Æ¥‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡Æï‡Ææ‡ÆØ‡Øç‡Æï‡Æ±‡Æø‡Æï‡Æ≥‡Øà ‡Æï‡Æ¥‡ØÅ‡Æµ‡Æµ‡ØÅ‡ÆÆ‡Øç

‚úÖ **‡Æ®‡Æø‡Æ©‡Øà‡Æµ‡Æø‡Æ≤‡Øç ‡Æï‡Øä‡Æ≥‡Øç‡Æ≥‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç:** ‡Æ§‡Æü‡ØÅ‡Æ™‡Øç‡Æ™‡ØÅ ‡Æé‡Æ™‡Øç‡Æ™‡Øã‡Æ§‡ØÅ‡ÆÆ‡Øç ‡Æö‡Æø‡Æï‡Æø‡Æö‡Øç‡Æö‡Øà‡ÆØ‡Øà ‡Æµ‡Æø‡Æü ‡Æö‡Æø‡Æ±‡Æ®‡Øç‡Æ§‡Æ§‡ØÅ!`
        },
        emergency: {
          keywords: ['‡ÆÖ‡Æµ‡Æö‡Æ∞‡ÆÆ‡Øç', 'emergency', '‡Æâ‡Æ§‡Æµ‡Æø', 'help'],
          response: `**üö® ‡ÆÖ‡Æµ‡Æö‡Æ∞ ‡Æ§‡Øä‡Æü‡Æ∞‡Øç‡Æ™‡ØÅ‡Æï‡Æ≥‡Øç:**

**‡Æâ‡Æü‡Æ©‡Æü‡Æø ‡Æé‡Æ£‡Øç‡Æï‡Æ≥‡Øç:**
üìû **‡ÆÜ‡ÆÆ‡Øç‡Æ™‡ØÅ‡Æ≤‡Æ©‡Øç‡Æ∏‡Øç:** 108 / 102
üìû **‡Æö‡ØÅ‡Æï‡Ææ‡Æ§‡Ææ‡Æ∞ ‡Æπ‡ØÜ‡Æ≤‡Øç‡Æ™‡Øç‡Æ≤‡Øà‡Æ©‡Øç:** 104 / 1075
üìû **‡ÆÖ‡Æµ‡Æö‡Æ∞ ‡Æö‡Øá‡Æµ‡Øà‡Æï‡Æ≥‡Øç:** 112

**‡Æé‡Æ™‡Øç‡Æ™‡Øã‡Æ§‡ØÅ ‡ÆÖ‡Æ¥‡Øà‡Æï‡Øç‡Æï ‡Æµ‡Øá‡Æ£‡Øç‡Æü‡ØÅ‡ÆÆ‡Øç:**
üö® ‡ÆÆ‡ÆØ‡Æï‡Øç‡Æï‡ÆÆ‡Øç ‡ÆÖ‡Æ≤‡Øç‡Æ≤‡Æ§‡ØÅ ‡Æï‡ØÅ‡Æ¥‡Æ™‡Øç‡Æ™‡ÆÆ‡Øç
üö® ‡Æï‡Æü‡ØÅ‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ© ‡ÆÆ‡ØÇ‡Æö‡Øç‡Æö‡ØÅ‡Æ§‡Øç‡Æ§‡Æø‡Æ£‡Æ±‡Æ≤‡Øç
üö® 104¬∞F ‡Æï‡Øç‡Æï‡ØÅ ‡ÆÆ‡Øá‡Æ≤‡Øç ‡Æï‡Ææ‡ÆØ‡Øç‡Æö‡Øç‡Æö‡Æ≤‡Øç

‚öïÔ∏è **‡Æö‡Æ∞‡Æø‡ÆØ‡Ææ‡Æ© ‡Æ®‡Øá‡Æ∞‡Æ§‡Øç‡Æ§‡Æø‡Æ≤‡Øç ‡ÆÆ‡Æ∞‡ØÅ‡Æ§‡Øç‡Æ§‡ØÅ‡Æµ ‡Æâ‡Æ§‡Æµ‡Æø ‡Æâ‡ÆØ‡Æø‡Æ∞‡Øà‡Æï‡Øç ‡Æï‡Ææ‡Æ™‡Øç‡Æ™‡Ææ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç!**`
        }
      },
      te: {
        cholera: {
          keywords: ['‡∞ï‡∞≤‡∞∞‡∞æ', 'cholera', '‡∞µ‡∞ø‡∞∞‡±á‡∞ö‡∞®‡∞æ‡∞≤‡±Å'],
          response: `**‡∞ï‡∞≤‡∞∞‡∞æ - ‡∞Æ‡±Å‡∞ñ‡±ç‡∞Ø ‡∞∏‡∞Æ‡∞æ‡∞ö‡∞æ‡∞∞‡∞Ç:**

üìã **‡∞ï‡∞≤‡∞∞‡∞æ ‡∞Ö‡∞Ç‡∞ü‡±á ‡∞è‡∞Æ‡∞ø‡∞ü‡∞ø?**
‡∞ï‡∞≤‡∞∞‡∞æ ‡∞Ö‡∞®‡±á‡∞¶‡∞ø ‡∞µ‡∞ø‡∞¨‡±ç‡∞∞‡∞ø‡∞Ø‡±ã ‡∞ï‡∞≤‡∞∞‡∞æ ‡∞¨‡±ç‡∞Ø‡∞æ‡∞ï‡±ç‡∞ü‡±Ä‡∞∞‡∞ø‡∞Ø‡∞æ ‡∞µ‡∞≤‡±ç‡∞≤ ‡∞µ‡∞ö‡±ç‡∞ö‡±á ‡∞§‡±Ä‡∞µ‡±ç‡∞∞‡∞Æ‡±à‡∞® ‡∞∏‡∞Ç‡∞ï‡±ç‡∞∞‡∞Æ‡∞£.

üî¨ **‡∞≤‡∞ï‡±ç‡∞∑‡∞£‡∞æ‡∞≤‡±Å:**
‚Ä¢ ‡∞§‡±Ä‡∞µ‡±ç‡∞∞‡∞Æ‡±à‡∞® ‡∞®‡±Ä‡∞ü‡∞ø ‡∞µ‡∞ø‡∞∞‡±á‡∞ö‡∞®‡∞æ‡∞≤‡±Å
‚Ä¢ ‡∞µ‡∞æ‡∞Ç‡∞§‡±Å‡∞≤‡±Å
‚Ä¢ ‡∞µ‡±á‡∞ó‡∞Ç‡∞ó‡∞æ ‡∞®‡∞ø‡∞∞‡±ç‡∞ú‡∞≤‡±Ä‡∞ï‡∞∞‡∞£‡∞Ç
‚Ä¢ ‡∞ï‡∞Ç‡∞°‡∞∞‡∞æ‡∞≤ ‡∞§‡∞ø‡∞Æ‡±ç‡∞Æ‡∞ø‡∞∞‡∞ø
‚Ä¢ ‡∞§‡∞ï‡±ç‡∞ï‡±Å‡∞µ ‡∞∞‡∞ï‡±ç‡∞§‡∞™‡±ã‡∞ü‡±Å

üíä **‡∞ö‡∞ø‡∞ï‡∞ø‡∞§‡±ç‡∞∏:**
‚Ä¢ ‡∞µ‡±Ü‡∞Ç‡∞ü‡∞®‡±á ORS
‚Ä¢ ‡∞§‡±Ä‡∞µ‡±ç‡∞∞‡∞Æ‡±à‡∞® ‡∞®‡∞ø‡∞∞‡±ç‡∞ú‡∞≤‡±Ä‡∞ï‡∞∞‡∞£‡∞æ‡∞®‡∞ø‡∞ï‡∞ø IV ‡∞¶‡±ç‡∞∞‡∞µ‡∞æ‡∞≤‡±Å
‚Ä¢ ‡∞µ‡±à‡∞¶‡±ç‡∞Ø‡±Å‡∞°‡±Å ‡∞∏‡±Ç‡∞ö‡∞ø‡∞Ç‡∞ö‡∞ø‡∞® ‡∞Ø‡∞æ‡∞Ç‡∞ü‡±Ä‡∞¨‡∞Ø‡∞æ‡∞ü‡∞ø‡∞ï‡±ç‡∞∏‡±ç

üõ°Ô∏è **‡∞®‡∞ø‡∞µ‡∞æ‡∞∞‡∞£:**
‚Ä¢ ‡∞∏‡±Å‡∞∞‡∞ï‡±ç‡∞∑‡∞ø‡∞§‡∞Æ‡±à‡∞®, ‡∞â‡∞°‡∞ø‡∞ï‡∞ø‡∞Ç‡∞ö‡∞ø‡∞® ‡∞®‡±Ä‡∞∞‡±Å ‡∞§‡±ç‡∞∞‡∞æ‡∞ó‡∞Ç‡∞°‡∞ø
‚Ä¢ ‡∞§‡∞∞‡∞ö‡±Å‡∞ó‡∞æ ‡∞ö‡±á‡∞§‡±Å‡∞≤‡±Å ‡∞ï‡∞°‡±Å‡∞ï‡±ç‡∞ï‡±ã‡∞Ç‡∞°‡∞ø
‚Ä¢ ‡∞Ü‡∞π‡∞æ‡∞∞‡∞æ‡∞®‡±ç‡∞®‡∞ø ‡∞¨‡∞æ‡∞ó‡∞æ ‡∞µ‡∞Ç‡∞°‡∞Ç‡∞°‡∞ø

‚öïÔ∏è **‡∞≤‡∞ï‡±ç‡∞∑‡∞£‡∞æ‡∞≤‡±Å ‡∞ï‡∞®‡∞ø‡∞™‡∞ø‡∞∏‡±ç‡∞§‡±á ‡∞µ‡±Ü‡∞Ç‡∞ü‡∞®‡±á ‡∞µ‡±à‡∞¶‡±ç‡∞Ø ‡∞∏‡∞π‡∞æ‡∞Ø‡∞Ç ‡∞™‡±ä‡∞Ç‡∞¶‡∞Ç‡∞°‡∞ø!**`
        },
        prevention: {
          keywords: ['‡∞®‡∞ø‡∞µ‡∞æ‡∞∞‡∞£', '‡∞∞‡∞ï‡±ç‡∞∑‡∞£', 'prevent'],
          response: `**‡∞®‡±Ä‡∞ü‡∞ø ‡∞¶‡±ç‡∞µ‡∞æ‡∞∞‡∞æ ‡∞µ‡∞ö‡±ç‡∞ö‡±á ‡∞µ‡±ç‡∞Ø‡∞æ‡∞ß‡±Å‡∞≤ ‡∞®‡∞ø‡∞µ‡∞æ‡∞∞‡∞£ ‡∞Æ‡∞æ‡∞∞‡±ç‡∞ó‡∞¶‡∞∞‡±ç‡∞∂‡∞ø:**

üíß **‡∞∏‡±Å‡∞∞‡∞ï‡±ç‡∞∑‡∞ø‡∞§‡∞Æ‡±à‡∞® ‡∞®‡±Ä‡∞∞‡±Å:**
‚Ä¢ ‡∞®‡±Ä‡∞ü‡∞ø‡∞®‡∞ø ‡∞ï‡∞®‡±Ä‡∞∏‡∞Ç 1 ‡∞®‡∞ø‡∞Æ‡∞ø‡∞∑‡∞Ç ‡∞â‡∞°‡∞ø‡∞ï‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø
‚Ä¢ ‡∞∂‡±Å‡∞¶‡±ç‡∞ß‡±Ä‡∞ï‡∞∞‡∞£ ‡∞Æ‡∞æ‡∞§‡±ç‡∞∞‡∞≤‡±Å ‡∞µ‡∞æ‡∞°‡∞Ç‡∞°‡∞ø
‚Ä¢ ‡∞∂‡±Å‡∞¶‡±ç‡∞ß‡∞Æ‡±à‡∞® ‡∞™‡∞æ‡∞§‡±ç‡∞∞‡∞≤‡∞≤‡±ã ‡∞®‡±Ä‡∞ü‡∞ø‡∞®‡∞ø ‡∞®‡∞ø‡∞≤‡±ç‡∞µ ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø

üßº **‡∞™‡∞∞‡∞ø‡∞∂‡±Å‡∞≠‡±ç‡∞∞‡∞§:**
‚Ä¢ ‡∞§‡∞ø‡∞®‡∞°‡∞æ‡∞®‡∞ø‡∞ï‡∞ø ‡∞Æ‡±Å‡∞Ç‡∞¶‡±Å ‡∞∏‡∞¨‡±ç‡∞¨‡±Å‡∞§‡±ã ‡∞ö‡±á‡∞§‡±Å‡∞≤‡±Å ‡∞ï‡∞°‡±Å‡∞ï‡±ç‡∞ï‡±ã‡∞Ç‡∞°‡∞ø
‚Ä¢ ‡∞ü‡∞æ‡∞Ø‡∞ø‡∞≤‡±Ü‡∞ü‡±ç ‡∞â‡∞™‡∞Ø‡±ã‡∞ó‡∞ø‡∞Ç‡∞ö‡∞ø‡∞® ‡∞§‡∞∞‡±ç‡∞µ‡∞æ‡∞§ ‡∞ö‡±á‡∞§‡±Å‡∞≤‡±Å ‡∞ï‡∞°‡±Å‡∞ï‡±ç‡∞ï‡±ã‡∞Ç‡∞°‡∞ø

üç≤ **‡∞Ü‡∞π‡∞æ‡∞∞ ‡∞≠‡∞¶‡±ç‡∞∞‡∞§:**
‚Ä¢ ‡∞Ü‡∞π‡∞æ‡∞∞‡∞æ‡∞®‡±ç‡∞®‡∞ø ‡∞¨‡∞æ‡∞ó‡∞æ ‡∞µ‡∞Ç‡∞°‡∞Ç‡∞°‡∞ø
‚Ä¢ ‡∞™‡∞Ç‡∞°‡±ç‡∞≤‡±Å ‡∞Æ‡∞∞‡∞ø‡∞Ø‡±Å ‡∞ï‡±Ç‡∞∞‡∞ó‡∞æ‡∞Ø‡∞≤‡∞®‡±Å ‡∞ï‡∞°‡∞ó‡∞Ç‡∞°‡∞ø

‚úÖ **‡∞ó‡±Å‡∞∞‡±ç‡∞§‡±Å‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø:** ‡∞®‡∞ø‡∞µ‡∞æ‡∞∞‡∞£ ‡∞é‡∞≤‡±ç‡∞≤‡∞™‡±ç‡∞™‡±Å‡∞°‡±Ç ‡∞ö‡∞ø‡∞ï‡∞ø‡∞§‡±ç‡∞∏ ‡∞ï‡∞Ç‡∞ü‡±á ‡∞Æ‡∞Ç‡∞ö‡∞ø‡∞¶‡∞ø!`
        }
      },
      bn: {
        cholera: {
          keywords: ['‡¶ï‡¶≤‡ßá‡¶∞‡¶æ', 'cholera', '‡¶°‡¶æ‡¶Ø‡¶º‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ'],
          response: `**‡¶ï‡¶≤‡ßá‡¶∞‡¶æ - ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶§‡¶•‡ßç‡¶Ø:**

üìã **‡¶ï‡¶≤‡ßá‡¶∞‡¶æ ‡¶ï‡¶ø?**
‡¶ï‡¶≤‡ßá‡¶∞‡¶æ ‡¶≠‡¶ø‡¶¨‡ßç‡¶∞‡¶ø‡¶ì ‡¶ï‡¶≤‡ßá‡¶∞‡¶ø ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶ü‡ßá‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ ‡¶¶‡ßç‡¶¨‡¶æ‡¶∞‡¶æ ‡¶∏‡ßÉ‡¶∑‡ßç‡¶ü ‡¶è‡¶ï‡¶ü‡¶ø ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡¶∞ ‡¶∏‡¶Ç‡¶ï‡ßç‡¶∞‡¶Æ‡¶£‡•§

üî¨ **‡¶â‡¶™‡¶∏‡¶∞‡ßç‡¶ó:**
‚Ä¢ ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡¶∞ ‡¶™‡¶æ‡¶®‡¶ø‡¶∞ ‡¶Æ‡¶§‡ßã ‡¶°‡¶æ‡¶Ø‡¶º‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ
‚Ä¢ ‡¶¨‡¶Æ‡¶ø
‚Ä¢ ‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶™‡¶æ‡¶®‡¶ø‡¶∂‡ßÇ‡¶®‡ßç‡¶Ø‡¶§‡¶æ
‚Ä¢ ‡¶™‡ßá‡¶∂‡ßÄ‡¶§‡ßá ‡¶ñ‡¶ø‡¶Å‡¶ö‡ßÅ‡¶®‡¶ø
‚Ä¢ ‡¶®‡¶ø‡¶Æ‡ßç‡¶® ‡¶∞‡¶ï‡ßç‡¶§‡¶ö‡¶æ‡¶™

üíä **‡¶ö‡¶ø‡¶ï‡¶ø‡ßé‡¶∏‡¶æ:**
‚Ä¢ ‡¶Ö‡¶¨‡¶ø‡¶≤‡¶Æ‡ßç‡¶¨‡ßá ORS
‚Ä¢ ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡¶∞ ‡¶™‡¶æ‡¶®‡¶ø‡¶∂‡ßÇ‡¶®‡ßç‡¶Ø‡¶§‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø IV ‡¶§‡¶∞‡¶≤
‚Ä¢ ‡¶°‡¶æ‡¶ï‡ßç‡¶§‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡¶æ‡¶Æ‡¶∞‡ßç‡¶∂ ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶ü‡¶ø‡¶¨‡¶æ‡¶Ø‡¶º‡ßã‡¶ü‡¶ø‡¶ï

üõ°Ô∏è **‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∞‡ßã‡¶ß:**
‚Ä¢ ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶¶, ‡¶´‡ßÅ‡¶ü‡¶æ‡¶®‡ßã ‡¶™‡¶æ‡¶®‡¶ø ‡¶™‡¶æ‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®
‚Ä¢ ‡¶ò‡¶® ‡¶ò‡¶® ‡¶π‡¶æ‡¶§ ‡¶ß‡ßÅ‡¶Ø‡¶º‡ßá ‡¶®‡¶ø‡¶®
‚Ä¢ ‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞ ‡¶≠‡¶æ‡¶≤‡ßã‡¶≠‡¶æ‡¶¨‡ßá ‡¶∞‡¶æ‡¶®‡ßç‡¶®‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®

‚öïÔ∏è **‡¶â‡¶™‡¶∏‡¶∞‡ßç‡¶ó ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶¶‡¶ø‡¶≤‡ßá ‡¶Ö‡¶¨‡¶ø‡¶≤‡¶Æ‡ßç‡¶¨‡ßá ‡¶ö‡¶ø‡¶ï‡¶ø‡ßé‡¶∏‡¶æ ‡¶∏‡¶π‡¶æ‡¶Ø‡¶º‡¶§‡¶æ ‡¶®‡¶ø‡¶®!**`
        },
        prevention: {
          keywords: ['‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∞‡ßã‡¶ß', '‡¶∏‡ßÅ‡¶∞‡¶ï‡ßç‡¶∑‡¶æ', 'prevent'],
          response: `**‡¶ú‡¶≤-‡¶¨‡¶æ‡¶π‡¶ø‡¶§ ‡¶∞‡ßã‡¶ó ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∞‡ßã‡¶ß ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡ßá‡¶∂‡¶ø‡¶ï‡¶æ:**

üíß **‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶¶ ‡¶™‡¶æ‡¶®‡¶ø:**
‚Ä¢ ‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá 1 ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü ‡¶™‡¶æ‡¶®‡¶ø ‡¶´‡ßÅ‡¶ü‡¶æ‡¶®
‚Ä¢ ‡¶¨‡¶ø‡¶∂‡ßÅ‡¶¶‡ßç‡¶ß‡¶ï‡¶∞‡¶£ ‡¶ü‡ßç‡¶Ø‡¶æ‡¶¨‡¶≤‡ßá‡¶ü ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®
‚Ä¢ ‡¶™‡¶∞‡¶ø‡¶∑‡ßç‡¶ï‡¶æ‡¶∞ ‡¶™‡¶æ‡¶§‡ßç‡¶∞‡ßá ‡¶™‡¶æ‡¶®‡¶ø ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®

üßº **‡¶™‡¶∞‡¶ø‡¶ö‡ßç‡¶õ‡¶®‡ßç‡¶®‡¶§‡¶æ:**
‚Ä¢ ‡¶ñ‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶Ü‡¶ó‡ßá ‡¶∏‡¶æ‡¶¨‡¶æ‡¶® ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶π‡¶æ‡¶§ ‡¶ß‡ßÅ‡¶Ø‡¶º‡ßá ‡¶®‡¶ø‡¶®
‚Ä¢ ‡¶ü‡¶Ø‡¶º‡¶≤‡ßá‡¶ü ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞‡ßá ‡¶π‡¶æ‡¶§ ‡¶ß‡ßÅ‡¶Ø‡¶º‡ßá ‡¶®‡¶ø‡¶®

üç≤ **‡¶ñ‡¶æ‡¶¶‡ßç‡¶Ø ‡¶∏‡ßÅ‡¶∞‡¶ï‡ßç‡¶∑‡¶æ:**
‚Ä¢ ‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞ ‡¶≠‡¶æ‡¶≤‡ßã‡¶≠‡¶æ‡¶¨‡ßá ‡¶∞‡¶æ‡¶®‡ßç‡¶®‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®
‚Ä¢ ‡¶´‡¶≤ ‡¶ì ‡¶∏‡¶¨‡¶ú‡¶ø ‡¶ß‡ßÅ‡¶Ø‡¶º‡ßá ‡¶®‡¶ø‡¶®

‚úÖ **‡¶Æ‡¶®‡ßá ‡¶∞‡¶æ‡¶ñ‡¶¨‡ßá‡¶®:** ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∞‡ßã‡¶ß ‡¶∏‡¶¨‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶ö‡¶ø‡¶ï‡¶ø‡ßé‡¶∏‡¶æ‡¶∞ ‡¶ö‡ßá‡¶Ø‡¶º‡ßá ‡¶≠‡¶æ‡¶≤!`
        }
      }
    };

    function setChatLanguage(lang) {
      chatLanguage = lang;
      
      // Update button states
      document.querySelectorAll('.language-btn[id^="chatLang"]').forEach(btn => {
        btn.classList.remove('active');
      });
      document.getElementById(`chatLang${lang.charAt(0).toUpperCase() + lang.slice(1)}`).classList.add('active');
      
      // Update welcome message based on language
      const welcomeMessages = {
        en: 'Hello! I\'m AISH, your health monitoring assistant. I can help you with waterborne diseases, prevention guidelines, treatment protocols, symptom identification, and emergency contacts. How can I assist you today?',
        hi: '‡§®‡§Æ‡§∏‡•ç‡§§‡•á! ‡§Æ‡•à‡§Ç AISH ‡§π‡•Ç‡§Ç, ‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø ‡§®‡§ø‡§ó‡§∞‡§æ‡§®‡•Ä ‡§∏‡§π‡§æ‡§Ø‡§ï‡•§ ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•ã ‡§ú‡§≤-‡§ú‡§®‡§ø‡§§ ‡§∞‡•ã‡§ó‡•ã‡§Ç, ‡§∞‡•ã‡§ï‡§•‡§æ‡§Æ ‡§¶‡§ø‡§∂‡§æ‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂‡•ã‡§Ç, ‡§â‡§™‡§ö‡§æ‡§∞ ‡§™‡•ç‡§∞‡•ã‡§ü‡•ã‡§ï‡•â‡§≤ ‡§î‡§∞ ‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤‡•Ä‡§® ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Ç‡•§ ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§ï‡•à‡§∏‡•á ‡§Æ‡§¶‡§¶ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Ç?',
        ta: '‡Æµ‡Æ£‡Æï‡Øç‡Æï‡ÆÆ‡Øç! ‡Æ®‡Ææ‡Æ©‡Øç AISH, ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æö‡ØÅ‡Æï‡Ææ‡Æ§‡Ææ‡Æ∞ ‡Æï‡Æ£‡Øç‡Æï‡Ææ‡Æ£‡Æø‡Æ™‡Øç‡Æ™‡ØÅ ‡Æâ‡Æ§‡Æµ‡Æø‡ÆØ‡Ææ‡Æ≥‡Æ∞‡Øç. ‡Æ®‡ØÄ‡Æ∞‡Øç‡Æµ‡Æ¥‡Æø ‡Æ®‡Øã‡ÆØ‡Øç‡Æï‡Æ≥‡Øç, ‡Æ§‡Æü‡ØÅ‡Æ™‡Øç‡Æ™‡ØÅ ‡Æµ‡Æ¥‡Æø‡Æï‡Ææ‡Æü‡Øç‡Æü‡ØÅ‡Æ§‡Æ≤‡Øç‡Æï‡Æ≥‡Øç, ‡Æö‡Æø‡Æï‡Æø‡Æö‡Øç‡Æö‡Øà ‡Æ®‡ØÜ‡Æ±‡Æø‡ÆÆ‡ØÅ‡Æ±‡Øà‡Æï‡Æ≥‡Øç ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡ÆÖ‡Æµ‡Æö‡Æ∞ ‡Æ§‡Øä‡Æü‡Æ∞‡Øç‡Æ™‡ØÅ‡Æï‡Æ≥‡Æø‡Æ≤‡Øç ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ ‡Æâ‡Æ§‡Æµ ‡ÆÆ‡ØÅ‡Æü‡Æø‡ÆØ‡ØÅ‡ÆÆ‡Øç. ‡Æá‡Æ©‡Øç‡Æ±‡ØÅ ‡Æ®‡Ææ‡Æ©‡Øç ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ ‡Æé‡Æ™‡Øç‡Æ™‡Æü‡Æø ‡Æâ‡Æ§‡Æµ ‡ÆÆ‡ØÅ‡Æü‡Æø‡ÆØ‡ØÅ‡ÆÆ‡Øç?',
        te: '‡∞®‡∞Æ‡∞∏‡±ç‡∞ï‡∞æ‡∞∞‡∞Ç! ‡∞®‡±á‡∞®‡±Å AISH, ‡∞Æ‡±Ä ‡∞Ü‡∞∞‡±ã‡∞ó‡±ç‡∞Ø ‡∞™‡∞∞‡±ç‡∞Ø‡∞µ‡±á‡∞ï‡±ç‡∞∑‡∞£ ‡∞∏‡∞π‡∞æ‡∞Ø‡∞ï‡±Å‡∞°‡∞®‡±Å. ‡∞®‡±Ä‡∞ü‡∞ø ‡∞¶‡±ç‡∞µ‡∞æ‡∞∞‡∞æ ‡∞µ‡∞ö‡±ç‡∞ö‡±á ‡∞µ‡±ç‡∞Ø‡∞æ‡∞ß‡±Å‡∞≤‡±Å, ‡∞®‡∞ø‡∞µ‡∞æ‡∞∞‡∞£ ‡∞Æ‡∞æ‡∞∞‡±ç‡∞ó‡∞¶‡∞∞‡±ç‡∞∂‡∞ï‡∞æ‡∞≤‡±Å, ‡∞ö‡∞ø‡∞ï‡∞ø‡∞§‡±ç‡∞∏ ‡∞™‡±ç‡∞∞‡±ã‡∞ü‡±ã‡∞ï‡∞æ‡∞≤‡±ç‡∞∏‡±ç ‡∞Æ‡∞∞‡∞ø‡∞Ø‡±Å ‡∞Ö‡∞§‡±ç‡∞Ø‡∞µ‡∞∏‡∞∞ ‡∞™‡∞∞‡∞ø‡∞ö‡∞Ø‡∞æ‡∞≤‡∞≤‡±ã ‡∞Æ‡±Ä‡∞ï‡±Å ‡∞∏‡∞π‡∞æ‡∞Ø‡∞Ç ‡∞ö‡±á‡∞Ø‡∞ó‡∞≤‡∞®‡±Å. ‡∞à‡∞∞‡±ã‡∞ú‡±Å ‡∞®‡±á‡∞®‡±Å ‡∞Æ‡±Ä‡∞ï‡±Å ‡∞é‡∞≤‡∞æ ‡∞∏‡∞π‡∞æ‡∞Ø‡∞Ç ‡∞ö‡±á‡∞Ø‡∞ó‡∞≤‡∞®‡±Å?',
        bn: '‡¶π‡ßç‡¶Ø‡¶æ‡¶≤‡ßã! ‡¶Ü‡¶Æ‡¶ø AISH, ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡ßç‡¶¨‡¶æ‡¶∏‡ßç‡¶•‡ßç‡¶Ø ‡¶™‡¶∞‡ßç‡¶Ø‡¶¨‡ßá‡¶ï‡ßç‡¶∑‡¶£ ‡¶∏‡¶π‡¶æ‡¶Ø‡¶º‡¶ï‡•§ ‡¶Ü‡¶Æ‡¶ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá ‡¶ú‡¶≤-‡¶¨‡¶æ‡¶π‡¶ø‡¶§ ‡¶∞‡ßã‡¶ó, ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∞‡ßã‡¶ß ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡ßá‡¶∂‡¶ø‡¶ï‡¶æ, ‡¶ö‡¶ø‡¶ï‡¶ø‡ßé‡¶∏‡¶æ ‡¶™‡ßç‡¶∞‡ßã‡¶ü‡ßã‡¶ï‡¶≤ ‡¶è‡¶¨‡¶Ç ‡¶ú‡¶∞‡ßÅ‡¶∞‡¶ø ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó‡ßá ‡¶∏‡¶æ‡¶π‡¶æ‡¶Ø‡ßç‡¶Ø ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶ø‡•§ ‡¶Ü‡¶ú ‡¶Ü‡¶Æ‡¶ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá ‡¶ï‡ßÄ‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡¶æ‡¶π‡¶æ‡¶Ø‡ßç‡¶Ø ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶ø?'
      };
      
      showNotification(`Language changed to ${lang.toUpperCase()}`, 'success');
    }
    window.setChatLanguage = setChatLanguage;

    function sendChatMessage() {
      const input = document.getElementById('chatInput');
      const message = input.value.trim();
      
      if (!message) return;
      
      // Add user message to chat
      addChatMessage(message, 'user');
      input.value = '';
      
      // Show thinking animation
      const chatMessages = document.getElementById('chatMessages');
      const thinkingDiv = document.createElement('div');
      thinkingDiv.className = 'bot-message';
      thinkingDiv.id = 'thinkingMessage';
      thinkingDiv.innerHTML = `
        <div style="font-weight: 600; color: #3498db; margin-bottom: 8px; font-size: 13px;">ü§ñ AISH Assistant</div>
        <div style="color: #2c3e50; font-size: 14px;">
          Analyzing your question<span class="ai-thinking"><span></span><span></span><span></span></span>
        </div>
      `;
      chatMessages.appendChild(thinkingDiv);
      chatMessages.scrollTop = chatMessages.scrollHeight;
      
      // Process message and respond
      setTimeout(() => {
        thinkingDiv.remove();
        const response = processUserMessage(message);
        addChatMessage(response, 'bot');
      }, 1500);
    }
    window.sendChatMessage = sendChatMessage;

    function askQuickQuestion(question) {
      document.getElementById('chatInput').value = question;
      sendChatMessage();
    }
    window.askQuickQuestion = askQuickQuestion;

    function processUserMessage(message) {
      const lowerMessage = message.toLowerCase();
      const kb = chatKnowledgeBase[chatLanguage] || chatKnowledgeBase.en;
      
      // Check for topic matches
      for (const [topic, data] of Object.entries(kb)) {
        if (data.keywords.some(keyword => lowerMessage.includes(keyword.toLowerCase()))) {
          return data.response;
        }
      }
      
      // Default response based on language
      const defaultResponses = {
        en: `I understand you're asking about: "${message}"\n\nI can help you with:\n‚Ä¢ Cholera information\n‚Ä¢ Typhoid fever details\n‚Ä¢ Dysentery guidance\n‚Ä¢ Prevention methods\n‚Ä¢ Treatment protocols\n‚Ä¢ Emergency contacts\n‚Ä¢ Water safety\n‚Ä¢ Symptom identification\n\nPlease ask about any of these topics, or try one of the quick topic buttons below!`,
        hi: `‡§Æ‡•à‡§Ç ‡§∏‡§Æ‡§ù‡§§‡§æ ‡§π‡•Ç‡§Ç ‡§ï‡§ø ‡§Ü‡§™ ‡§™‡•Ç‡§õ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç: "${message}"\n\n‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§Æ‡§¶‡§¶ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Ç:\n‚Ä¢ ‡§π‡•à‡§ú‡§æ ‡§ï‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä\n‚Ä¢ ‡§ü‡§æ‡§á‡§´‡§æ‡§á‡§° ‡§µ‡§ø‡§µ‡§∞‡§£\n‚Ä¢ ‡§™‡•á‡§ö‡§ø‡§∂ ‡§Æ‡§æ‡§∞‡•ç‡§ó‡§¶‡§∞‡•ç‡§∂‡§®\n‚Ä¢ ‡§∞‡•ã‡§ï‡§•‡§æ‡§Æ ‡§ï‡•á ‡§§‡§∞‡•Ä‡§ï‡•á\n‚Ä¢ ‡§â‡§™‡§ö‡§æ‡§∞ ‡§™‡•ç‡§∞‡•ã‡§ü‡•ã‡§ï‡•â‡§≤\n‚Ä¢ ‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤‡•Ä‡§® ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï\n\n‡§ï‡•É‡§™‡§Ø‡§æ ‡§á‡§® ‡§µ‡§ø‡§∑‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§™‡•Ç‡§õ‡•á‡§Ç!`,
        ta: `‡Æ®‡ØÄ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æï‡Øá‡Æü‡Øç‡Æ™‡Æ§‡ØÅ ‡Æ™‡ØÅ‡Æ∞‡Æø‡Æï‡Æø‡Æ±‡Æ§‡ØÅ: "${message}"\n\n‡Æ®‡Ææ‡Æ©‡Øç ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ ‡Æâ‡Æ§‡Æµ ‡ÆÆ‡ØÅ‡Æü‡Æø‡ÆØ‡ØÅ‡ÆÆ‡Øç:\n‚Ä¢ ‡Æï‡Ææ‡Æ≤‡Æ∞‡Ææ ‡Æ§‡Æï‡Æµ‡Æ≤‡Øç\n‚Ä¢ ‡Æü‡Øà‡Æ™‡Ææ‡ÆØ‡Øç‡Æü‡ØÅ ‡Æµ‡Æø‡Æµ‡Æ∞‡Æô‡Øç‡Æï‡Æ≥‡Øç\n‚Ä¢ ‡Æµ‡ÆØ‡Æø‡Æ±‡Øç‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Øã‡Æï‡Øç‡Æï‡ØÅ ‡Æµ‡Æ¥‡Æø‡Æï‡Ææ‡Æü‡Øç‡Æü‡ØÅ‡Æ§‡Æ≤‡Øç\n‚Ä¢ ‡Æ§‡Æü‡ØÅ‡Æ™‡Øç‡Æ™‡ØÅ ‡ÆÆ‡ØÅ‡Æ±‡Øà‡Æï‡Æ≥‡Øç\n‚Ä¢ ‡Æö‡Æø‡Æï‡Æø‡Æö‡Øç‡Æö‡Øà ‡Æ®‡ØÜ‡Æ±‡Æø‡ÆÆ‡ØÅ‡Æ±‡Øà‡Æï‡Æ≥‡Øç\n‚Ä¢ ‡ÆÖ‡Æµ‡Æö‡Æ∞ ‡Æ§‡Øä‡Æü‡Æ∞‡Øç‡Æ™‡ØÅ‡Æï‡Æ≥‡Øç\n\n‡Æ§‡ÆØ‡Æµ‡ØÅ‡Æö‡ØÜ‡ÆØ‡Øç‡Æ§‡ØÅ ‡Æá‡Æ®‡Øç‡Æ§ ‡Æ§‡Æ≤‡Øà‡Æ™‡Øç‡Æ™‡ØÅ‡Æï‡Æ≥‡Æø‡Æ≤‡Øç ‡Æï‡Øá‡Æ≥‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç!`,
        te: `‡∞Æ‡±Ä‡∞∞‡±Å ‡∞Ö‡∞°‡±Å‡∞ó‡±Å‡∞§‡±Å‡∞®‡±ç‡∞®‡∞¶‡∞ø ‡∞Ö‡∞∞‡±ç‡∞•‡∞Æ‡±à‡∞Ç‡∞¶‡∞ø: "${message}"\n\n‡∞®‡±á‡∞®‡±Å ‡∞Æ‡±Ä‡∞ï‡±Å ‡∞∏‡∞π‡∞æ‡∞Ø‡∞Ç ‡∞ö‡±á‡∞Ø‡∞ó‡∞≤‡∞®‡±Å:\n‚Ä¢ ‡∞ï‡∞≤‡∞∞‡∞æ ‡∞∏‡∞Æ‡∞æ‡∞ö‡∞æ‡∞∞‡∞Ç\n‚Ä¢ ‡∞ü‡±à‡∞´‡∞æ‡∞Ø‡∞ø‡∞°‡±ç ‡∞µ‡∞ø‡∞µ‡∞∞‡∞æ‡∞≤‡±Å\n‚Ä¢ ‡∞µ‡∞ø‡∞∞‡±á‡∞ö‡∞®‡∞æ‡∞≤ ‡∞Æ‡∞æ‡∞∞‡±ç‡∞ó‡∞¶‡∞∞‡±ç‡∞∂‡∞ï‡∞§‡±ç‡∞µ‡∞Ç\n‚Ä¢ ‡∞®‡∞ø‡∞µ‡∞æ‡∞∞‡∞£ ‡∞™‡∞¶‡±ç‡∞ß‡∞§‡±Å‡∞≤‡±Å\n‚Ä¢ ‡∞ö‡∞ø‡∞ï‡∞ø‡∞§‡±ç‡∞∏ ‡∞™‡±ç‡∞∞‡±ã‡∞ü‡±ã‡∞ï‡∞æ‡∞≤‡±ç‡∞∏‡±ç\n‚Ä¢ ‡∞Ö‡∞§‡±ç‡∞Ø‡∞µ‡∞∏‡∞∞ ‡∞™‡∞∞‡∞ø‡∞ö‡∞Ø‡∞æ‡∞≤‡±Å\n\n‡∞¶‡∞Ø‡∞ö‡±á‡∞∏‡∞ø ‡∞à ‡∞Ö‡∞Ç‡∞∂‡∞æ‡∞≤ ‡∞ó‡±Å‡∞∞‡∞ø‡∞Ç‡∞ö‡∞ø ‡∞Ö‡∞°‡∞ó‡∞Ç‡∞°‡∞ø!`,
        bn: `‡¶Ü‡¶Æ‡¶ø ‡¶¨‡ßÅ‡¶ù‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶õ‡¶ø ‡¶Ü‡¶™‡¶®‡¶ø ‡¶ú‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶∏‡¶æ ‡¶ï‡¶∞‡¶õ‡ßá‡¶®: "${message}"\n\n‡¶Ü‡¶Æ‡¶ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá ‡¶∏‡¶æ‡¶π‡¶æ‡¶Ø‡ßç‡¶Ø ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶ø:\n‚Ä¢ ‡¶ï‡¶≤‡ßá‡¶∞‡¶æ ‡¶§‡¶•‡ßç‡¶Ø\n‚Ä¢ ‡¶ü‡¶æ‡¶á‡¶´‡¶Ø‡¶º‡ßá‡¶° ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£\n‚Ä¢ ‡¶Ü‡¶Æ‡¶æ‡¶∂‡¶Ø‡¶º ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡ßá‡¶∂‡¶®‡¶æ\n‚Ä¢ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∞‡ßã‡¶ß‡ßá‡¶∞ ‡¶™‡¶¶‡ßç‡¶ß‡¶§‡¶ø\n‚Ä¢ ‡¶ö‡¶ø‡¶ï‡¶ø‡ßé‡¶∏‡¶æ ‡¶™‡ßç‡¶∞‡ßã‡¶ü‡ßã‡¶ï‡¶≤\n‚Ä¢ ‡¶ú‡¶∞‡ßÅ‡¶∞‡¶ø ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó\n\n‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶è‡¶á ‡¶¨‡¶ø‡¶∑‡¶Ø‡¶º‡¶ó‡ßÅ‡¶≤‡¶ø ‡¶∏‡¶Æ‡ßç‡¶™‡¶∞‡ßç‡¶ï‡ßá ‡¶ú‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶∏‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®!`
      };
      
      return defaultResponses[chatLanguage] || defaultResponses.en;
    }

    function addChatMessage(message, type) {
      const chatMessages = document.getElementById('chatMessages');
      const messageDiv = document.createElement('div');
      messageDiv.className = `chat-message ${type}-message`;
      
      if (type === 'bot') {
        messageDiv.innerHTML = `
          <div style="font-weight: 600; color: #3498db; margin-bottom: 8px; font-size: 13px;">ü§ñ AISH Assistant</div>
          <div style="color: #2c3e50; font-size: 14px; line-height: 1.6; white-space: pre-line;">${message}</div>
        `;
      } else {
        messageDiv.innerHTML = `
          <div style="font-weight: 600; color: #2196f3; margin-bottom: 8px; font-size: 13px;">You</div>
          <div style="color: #2c3e50; font-size: 14px; line-height: 1.6;">${message}</div>
        `;
      }
      
      chatMessages.appendChild(messageDiv);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    // Toggle Chatbot Popup
    function toggleChatbot() {
      const chatbotPopup = document.getElementById('chatbotPopup');
      const chatbotToggle = document.getElementById('chatbotToggle');
      
      chatbotPopup.classList.toggle('active');
      chatbotToggle.classList.toggle('active');
    }
    window.toggleChatbot = toggleChatbot;

    // Load sync queue
    syncQueue = loadFromStorage('syncQueue') || [];

    // ‚îÄ‚îÄ Keep Render server awake (ping every 10 mins) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function pingServer() {
      fetch(`${API_URL}/health`, { cache: 'no-store' })
        .then(() => console.log('‚úì Server is awake'))
        .catch(() => console.log('‚ö† Server sleeping, waking up...'));
    }
    pingServer();
    setInterval(pingServer, 10 * 60 * 1000);

    // ‚îÄ‚îÄ Auto-refresh every 30 seconds for multi-user live sync ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // When Doctor B submits a case, Doctor A's screen updates within 30s
    setInterval(async () => {
      if (serverAvailable && isOnline) {
        await fetchAllCases();
      }
    }, 30 * 1000);
  </script>
</body>
</html>
